<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Purel.in</title>
  
  <subtitle>Pure Life, Learn, Leadership, Love</subtitle>
  <link href="https://purel.in/atom.xml" rel="self"/>
  
  <link href="https://purel.in/"/>
  <updated>2022-03-23T03:01:50.000Z</updated>
  <id>https://purel.in/</id>
  
  <author>
    <name>徐哞哞</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Hexo同步部署到Github与VPS或树莓派</title>
    <link href="https://purel.in/Deploy-Hexo-to-Raspberry-Pi-and-Github/"/>
    <id>https://purel.in/Deploy-Hexo-to-Raspberry-Pi-and-Github/</id>
    <published>2022-03-23T03:01:50.000Z</published>
    <updated>2022-03-23T03:01:50.000Z</updated>
    
    <content type="html"><![CDATA[<p><img src="/images/2020/04/hexopi.jpg" class="lazyload" data-srcset="/images/2020/04/hexopi.jpg" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="><br>这篇文章记录了我是如何实现通过一个指令将VPS或树莓派生成的文章发布到互联网，以及即便换了电脑也可以一键拉取Github上全部Hexo的备份，快速完成本地Hexo部署。</p><span id="more"></span><h2 id="1-安装Git"><a href="#1-安装Git" class="headerlink" title="1. 安装Git"></a>1. 安装Git</h2><div class="story post-story"><h3 id="1-1-将Git部署到VPS"><a href="#1-1-将Git部署到VPS" class="headerlink" title="1.1 将Git部署到VPS"></a>1.1 将Git部署到VPS</h3><p>VPS服务器请注意设置防火墙相关端口开放，VPS则建议安装ufw解决一切防火墙端口问题造成的坑。<br>首先通过指令<code>apt install git</code>安装Git和Node.js，如果是CentOS服务器需要把apt换成yum，我这里主要以VPS或树莓派的Debian环境来记录整个部署过程。</p><h3 id="1-2-全局修改Github用户名"><a href="#1-2-全局修改Github用户名" class="headerlink" title="1.2 全局修改Github用户名"></a>1.2 全局修改Github用户名</h3><p>在VPS终端输入下列命令修改全局用户名（注意将引号内替换为个人帐号）：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git config --global user.name &quot;你的GitHub用户名&quot;</span><br><span class="line">git config --global user.email &quot;你的GitHub邮箱&quot;</span><br></pre></td></tr></table></figure><p>然后查看是否已经全局修改用户名：<br><code>git config --list</code><br>返回显示下面信息就是正确了</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">user.name=你的用户名</span><br><span class="line">user.email=你的邮箱</span><br></pre></td></tr></table></figure><p>安装NodeJS</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl --silent --location https://rpm.nodesource.com/setup_13.x | bash -</span><br></pre></td></tr></table></figure><p>或者</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">apt install npm</span><br><span class="line">npm install n -g</span><br><span class="line">n stable</span><br></pre></td></tr></table></figure><p>添加git用户</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">adduser git </span><br><span class="line">chmod 740 /etc/sudoers </span><br><span class="line">nano /etc/sudoers </span><br></pre></td></tr></table></figure><p>找到以下内容 </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">## Allow root to run any commands anywhere </span><br><span class="line">root ALL=(ALL) ALL </span><br></pre></td></tr></table></figure><p>在下面添加一行<br><code>git ALL=(ALL) ALL</code><br>保存退出并改回权限<br><code>chmod 400 /etc/sudoers</code><br>设置 git 用户密码<br><code>sudo passwd git</code><br>切换至git用户，创建 ~&#x2F;.ssh 文件夹和 ~&#x2F;.ssh&#x2F;authorized_keys 文件，并赋予相应的权限</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">su git </span><br><span class="line">mkdir ~/.ssh </span><br><span class="line">nano ~/.ssh/authorized_keys </span><br></pre></td></tr></table></figure><p>设置SSH Key要回到Mac&#x2F;PC本机终端内执行：ssh-keygen -t rsa -C “邮箱地址”，根据提示输入密码等完成设置。查看公开密钥：cat ~&#x2F;.ssh&#x2F;id_rsa.pub复制显示的内容。将公钥复制粘贴到</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">chmod 600 ~/.ssh/authorized_keys</span><br><span class="line">chmod 700 ~/.ssh</span><br></pre></td></tr></table></figure><p>在Mac Git Bash 中测试<br><code>ssh -v git@ip地址 # 服务器外网地址</code></p><p>测试后如果不需要密码则成功！</p><p>如果是VPS本机从root部署到git，需要注意切换用户来生成和保存密钥。指令和上面一样，在root用户和默认目录下生成ssh并保存至git默认目录即可。</p></div><h2 id="2-部署Nginx环境"><a href="#2-部署Nginx环境" class="headerlink" title="2. 部署Nginx环境"></a>2. 部署Nginx环境</h2><div class="story post-story"><p>如果还想部署多个网站或者安装lnmp环境，建议使用OneInStack来一键部署。若是单纯为了Hexo，只安装Nginx就足够了，轻量化的部署可以有效减少树莓派的负载。</p><h3 id="2-1-安装"><a href="#2-1-安装" class="headerlink" title="2.1 安装"></a>2.1 安装</h3><p><code>apt install nginx</code></p><h3 id="2-2-启动"><a href="#2-2-启动" class="headerlink" title="2.2 启动"></a>2.2 启动</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">systemctl start nginx # 启动</span><br><span class="line">systemctl enable nginx # 开机启动</span><br></pre></td></tr></table></figure><p>输入服务器外网地址出现nginx信息表示启动成功。</p><h3 id="2-3-配置"><a href="#2-3-配置" class="headerlink" title="2.3 配置"></a>2.3 配置</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nano /etc/nginx/nginx.conf</span><br></pre></td></tr></table></figure><p>修改内容 server 下<br>server_name 如有域名可以改为自己的;<br>location &#x2F; {<br>  root &#x2F;usr&#x2F;share&#x2F;nginx&#x2F;html&#x2F;blog; # 此处增加为”&#x2F;blog”,root指向博客所在目录<br>  …<br>}<br>修改内容头部<code>user  nginx;</code>更改为<code>user  root;</code><br>保存退出后执行：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo mkdir -p /usr/share/nginx/html/blog</span><br><span class="line">sudo chown -R git:git /usr/share/nginx/html/blog</span><br></pre></td></tr></table></figure></div><h2 id="3-部署Git库"><a href="#3-部署Git库" class="headerlink" title="3. 部署Git库"></a>3. 部署Git库</h2><div class="story post-story"><h3 id="3-1-在派初始化一个git裸库"><a href="#3-1-在派初始化一个git裸库" class="headerlink" title="3.1 在派初始化一个git裸库"></a>3.1 在派初始化一个git裸库</h3><p>切换到git用户，然后切换到git用户目录，接着初始化裸库：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">su git</span><br><span class="line">cd ~</span><br><span class="line">git init --bare blog.git</span><br></pre></td></tr></table></figure><h3 id="3-2-新建post-receive文件"><a href="#3-2-新建post-receive文件" class="headerlink" title="3.2 新建post-receive文件"></a>3.2 新建post-receive文件</h3><p><code>nano ~/blog.git/hooks/post-receive</code><br>然后在该文件中输入以下内容，注意把<code>/www/wwwroot/purel.in</code>改为你自己的网站目录</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#！/bin/sh</span><br><span class="line">git --work-tree=/www/wwwroot/purel.in --git-dir=/home/git/blog.git checkout -f</span><br></pre></td></tr></table></figure><h3 id="3-3-备选方案"><a href="#3-3-备选方案" class="headerlink" title="3.3 备选方案"></a>3.3 备选方案</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">#!/bin/bash</span><br><span class="line">GIT_REPO=/home/git/blog.git</span><br><span class="line">TMP_GIT_CLONE=/tmp/blog</span><br><span class="line">PUBLIC_WWW=/www/wwwroot/purel.in</span><br><span class="line">rm -rf $&#123;TMP_GIT_CLONE&#125;</span><br><span class="line">git clone $GIT_REPO $TMP_GIT_CLONE</span><br><span class="line">rm -rf $&#123;PUBLIC_WWW&#125;/*</span><br><span class="line">cp -rf $&#123;TMP_GIT_CLONE&#125;/* $&#123;PUBLIC_WWW&#125;</span><br></pre></td></tr></table></figure><h3 id="3-4-赋予权限"><a href="#3-4-赋予权限" class="headerlink" title="3.4 赋予权限"></a>3.4 赋予权限</h3><p>以上两种二选一，保存退出之后再输入以下代码，赋予该文件可执行权限:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">chmod +x ~/blog.git/hooks/post-receive</span><br><span class="line">chown git:git -R /www/wwwroot/purel.in</span><br></pre></td></tr></table></figure></div><h2 id="4-同时部署多平台设置"><a href="#4-同时部署多平台设置" class="headerlink" title="4. 同时部署多平台设置"></a>4. 同时部署多平台设置</h2><div class="story post-story"><p>编辑blog&#x2F;_config.yml设置repo源，pi是VPS的git库，它被指向部署到我们刚刚设置的nginx网站目录，使之可以被访问。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">repo: </span><br><span class="line">  vps: git@VPS_IP:/home/git/blog.git</span><br><span class="line">  github: https://github.com/yourname/yourname.github.io</span><br><span class="line">branch: master</span><br><span class="line">message:</span><br></pre></td></tr></table></figure></div><h2 id="5-发布或调试Hexo博客"><a href="#5-发布或调试Hexo博客" class="headerlink" title="5. 发布或调试Hexo博客"></a>5. 发布或调试Hexo博客</h2><div class="story post-story"><p><code>hexo clean &amp;&amp; hexo g</code><br>清除并生成新的Hexo网站<br><code>hexo clean &amp;&amp; hexo g -d</code><br>清除、生成新的网站并发布到Git或服务器<br>通过以上指令发布后打开vps的网址就能看到新的hexo博客啦，也可以通过<code>hexo s</code>在浏览器打开<code>localhost:4000</code>进行本地调试Hexo。</p></div><h2 id="6-安装和卸载Hexo插件"><a href="#6-安装和卸载Hexo插件" class="headerlink" title="6. 安装和卸载Hexo插件"></a>6. 安装和卸载Hexo插件</h2><div class="story post-story"><h3 id="6-1-通过npm安装插件"><a href="#6-1-通过npm安装插件" class="headerlink" title="6.1 通过npm安装插件"></a>6.1 通过npm安装插件</h3><h4 id="npm-切换-cnpm"><a href="#npm-切换-cnpm" class="headerlink" title="npm 切换 cnpm"></a>npm 切换 cnpm</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install -g cnpm --registry=https:<span class="comment">//registry.npm.taobao.org</span></span><br></pre></td></tr></table></figure><p>cnpm是淘宝在中国搭建的npm副本，保证中国用户使用依赖不受网路的影响。</p><h4 id="cnpm-切换-npm"><a href="#cnpm-切换-npm" class="headerlink" title="cnpm 切换 npm"></a>cnpm 切换 npm</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm config set registry https:<span class="comment">//registry.npmjs.org</span></span><br></pre></td></tr></table></figure><h4 id="安装插件"><a href="#安装插件" class="headerlink" title="安装插件"></a>安装插件</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">cnpm install hexo-deployer-git --save #安装git部署</span><br><span class="line">cnpm install --save hexo-admin #安装后台发布</span><br><span class="line">cnpm install hexo-generator-feed --save #安装rss生成</span><br><span class="line">cnpm install hexo-generator-sitemap --save #安装sitemap</span><br><span class="line">cnpm i -S hexo-generator-search hexo-generator-json-content #搜索依赖包</span><br><span class="line">cnpm i -S hexo-renderer-stylus #安装stylus渲染器</span><br><span class="line">cnpm i -S hexo-helper-qrcode #qr二维码插件</span><br><span class="line">cnpm i -S hexo-related-popular-posts #安装相关文章插件</span><br><span class="line">cnpm i hexo-offline --save #加载加速插件</span><br><span class="line">cnpm install hexo-lazyload-image --save #图片懒加载</span><br></pre></td></tr></table></figure><h3 id="6-2-卸载插件"><a href="#6-2-卸载插件" class="headerlink" title="6.2 卸载插件"></a>6.2 卸载插件</h3><p><code>npm list</code>查看已安装的插件列表<br><code>npm uninstall &lt;插件名&gt;</code> #卸载哞个插件<br>进入node_modules&#x2F;目录删除对应的插件文件<br><code>rm -rf &lt;插件名&gt;</code> #删除插件目录<br>清除cache缓存<br><code>npm cache clean -f</code><br>至此插件干干净净的卸载完毕</p></div><h2 id="7-备份整个Hexo"><a href="#7-备份整个Hexo" class="headerlink" title="7. 备份整个Hexo"></a>7. 备份整个Hexo</h2><div class="story post-story"><h3 id="7-1-在Github新建分支"><a href="#7-1-在Github新建分支" class="headerlink" title="7.1 在Github新建分支"></a>7.1 在Github新建分支</h3><p>在master下新建分支名为hexo，setting-branch下修改default源为hexo，然后<br>git clone到本地，在MacOS下 Command+Shift+. 查看隐藏文件，删除该目录下.git外所有文件，VPS则在文件夹点击右键显示隐藏文件。</p><p>新建或修改.gitignore用来忽略一些不需要的文件</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">.DS_Store</span><br><span class="line">Thumbs.db</span><br><span class="line">db.json</span><br><span class="line">*.log</span><br><span class="line">node_modules/</span><br><span class="line">public/</span><br><span class="line">.deploy*/</span><br></pre></td></tr></table></figure><h3 id="7-2-PUSH到Github"><a href="#7-2-PUSH到Github" class="headerlink" title="7.2 PUSH到Github"></a>7.2 PUSH到Github</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git add .</span><br><span class="line">git commit -m “注释”</span><br><span class="line">git push</span><br></pre></td></tr></table></figure><h3 id="7-3-Git的常用指令"><a href="#7-3-Git的常用指令" class="headerlink" title="7.3 Git的常用指令"></a>7.3 Git的常用指令</h3><p>add、commit、push命令，简单的代码提交流程<br><code>git status</code> 查看工作区代码相对于暂存区的差别<br><code>git add . </code>将当前目录下修改的所有代码从工作区添加到暂存区 . 代表当前目录<br><code>git commit -m ‘注释’ </code>将缓存区内容添加到本地仓库<br><code>git push origin master </code>将本地版本库推送到远程服务器，<br>origin是远程主机，master表示是远程服务器上的master分支，分支名是可以修改的</p><h3 id="7-4-一键发布博客并完整备份"><a href="#7-4-一键发布博客并完整备份" class="headerlink" title="7.4 一键发布博客并完整备份"></a>7.4 一键发布博客并完整备份</h3><p>现在Github有两个分支，一个是master用于存放Hexo生成的public文件，上文我们新建的hexo分支用于存放Hexo的完整备份。</p><h4 id="7-4-1-发布博客指令"><a href="#7-4-1-发布博客指令" class="headerlink" title="7.4.1 发布博客指令"></a>7.4.1 发布博客指令</h4><p><code>hexo clean &amp;&amp; hexo g -d</code></p><h4 id="7-4-2-备份完整的Hexo"><a href="#7-4-2-备份完整的Hexo" class="headerlink" title="7.4.2 备份完整的Hexo"></a>7.4.2 备份完整的Hexo</h4><p>同步Hexo完整备份到Github分支hexo<br><code>git add . &amp;&amp; git commit –m &quot;注释&quot; &amp;&amp; git push</code></p></div><h2 id="8-升级nodejs的方法"><a href="#8-升级nodejs的方法" class="headerlink" title="8. 升级nodejs的方法"></a>8. 升级nodejs的方法</h2><div class="story post-story"><p>更新升级node版本的方法如下：</p><h3 id="8-1-查看当前node版本"><a href="#8-1-查看当前node版本" class="headerlink" title="8.1 查看当前node版本"></a>8.1 查看当前node版本</h3><p><code>node –v</code></p><h3 id="8-2-安装n模块"><a href="#8-2-安装n模块" class="headerlink" title="8.2 安装n模块"></a>8.2 安装n模块</h3><p><code>npm install -g n</code></p><h3 id="8-3-升级到指定版本-x2F-最新版本"><a href="#8-3-升级到指定版本-x2F-最新版本" class="headerlink" title="8.3 升级到指定版本&#x2F;最新版本"></a>8.3 升级到指定版本&#x2F;最新版本</h3><p>该步骤可能需要花费一些时间。升级之前，可以执行<code>n ls</code>查看可升级的版本，如：<code>n 6.9.1</code><br>或者你也可以告诉管理器，安装最新的稳定版本<br><code>n stable</code></p><h3 id="8-4-检查升级是否成功"><a href="#8-4-检查升级是否成功" class="headerlink" title="8.4 检查升级是否成功"></a>8.4 检查升级是否成功</h3><p><code>node -v</code><br>如果得到的版本信息不正确，可能需要重启机器。</p><h3 id="8-5-常见问题"><a href="#8-5-常见问题" class="headerlink" title="8.5 常见问题"></a>8.5 常见问题</h3><p>如果遇到npm指令出现错误比如<code>Error: Cannot find module &#39;semver&#39;</code><br>重新安装最新版本即可：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">curl -sL https://deb.nodesource.com/setup_13.x | sudo -E bash -</span><br><span class="line">apt-get update</span><br><span class="line">apt-get install nodejs</span><br></pre></td></tr></table></figure><p>之后检查它们是否被正确部署</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">node -v</span><br><span class="line">nodes -v</span><br><span class="line">npm -v</span><br></pre></td></tr></table></figure><p>全部正确输出则代表安装正确。<br>然后重新安装Hexo<br><code>npm install -g hexo-cli</code></p></div>]]></content>
    
    
    <summary type="html">&lt;p&gt;&lt;img src=&quot;/images/2020/04/hexopi.jpg&quot;&gt;&lt;br&gt;这篇文章记录了我是如何实现通过一个指令将VPS或树莓派生成的文章发布到互联网，以及即便换了电脑也可以一键拉取Github上全部Hexo的备份，快速完成本地Hexo部署。&lt;/p&gt;</summary>
    
    
    
    <category term="网站" scheme="https://purel.in/categories/%E7%BD%91%E7%AB%99/"/>
    
    
    <category term="Purel.in" scheme="https://purel.in/tags/Purel-in/"/>
    
    <category term="Hexo" scheme="https://purel.in/tags/Hexo/"/>
    
    <category term="Github" scheme="https://purel.in/tags/Github/"/>
    
    <category term="VPS" scheme="https://purel.in/tags/VPS/"/>
    
  </entry>
  
  <entry>
    <title>frp全自动化守护进程</title>
    <link href="https://purel.in/frp-fully-automated-daemon/"/>
    <id>https://purel.in/frp-fully-automated-daemon/</id>
    <published>2020-04-13T07:19:06.000Z</published>
    <updated>2020-04-13T07:19:06.000Z</updated>
    
    <content type="html"><![CDATA[<p><img src="/images/2020/04/frp.png" class="lazyload" data-srcset="/images/2020/04/frp.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="><br>一觉睡醒后发现树莓派上的博客无法访问了，通过检查日志找到了原因，原来是一向乖巧的frp服务被莫名中断，看起来它也有脆弱的一面呀。世间万物都在进化，是时候实现frp的自我管理了，让它可以在各种原因中断后自行检查并自行恢复。这篇文章记录了我是如何高效且快速创建一个frp全自动化守护进程的。</p><span id="more"></span><p>frp分为frpc客户端和frps服务器端，这里以frpc为例，frps是一样的，只需要把以下目录或代码frpc或frpcd改成frps或frpsd。</p><h2 id="1-创建frpc开机启动"><a href="#1-创建frpc开机启动" class="headerlink" title="1. 创建frpc开机启动"></a>1. 创建frpc开机启动</h2><div class="story post-story"><p>创建一个systemctl文件</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nano /lib/systemd/system/frpc.service</span><br></pre></td></tr></table></figure><p>保存以下内容</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">[Unit]</span><br><span class="line">Description=frpc service</span><br><span class="line">#设置网络启动后依赖</span><br><span class="line">After=network.target syslog.target network-online.target</span><br><span class="line">Wants=network.target</span><br><span class="line">Requires=network-online.target</span><br><span class="line"></span><br><span class="line">[Service]</span><br><span class="line">Type=simple</span><br><span class="line">#启动服务的命令（此处写你的frps(frpc)的实际安装目录）</span><br><span class="line">ExecStart=/usr/local/frp/frpc -c /usr/local/frp/frpc.ini</span><br><span class="line">#设置失败5秒后重启</span><br><span class="line">Restart=on-failure</span><br><span class="line">RestartSec=5s</span><br><span class="line">KillSignal=SIGQUIT</span><br><span class="line">TimeoutStopSec=5</span><br><span class="line">KillMode=process</span><br><span class="line">PrivateTmp=true</span><br><span class="line"></span><br><span class="line">[Install]</span><br><span class="line">WantedBy=multi-user.target</span><br></pre></td></tr></table></figure><p>开启frpc开机启动<br><code>systemctl enable frpc.service</code></p></div><h2 id="2-创建frpcd守护进程"><a href="#2-创建frpcd守护进程" class="headerlink" title="2. 创建frpcd守护进程"></a>2. 创建frpcd守护进程</h2><div class="story post-story"><p>接下来需要实现实时检查frpc状态，如果frpc运行失败则重启服务，以免你睡觉的时候frp因各种原因中断服务。<br>首先创建一个frpcd.sh文件</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nano /usr/local/frp/frpcd.sh</span><br></pre></td></tr></table></figure><p>保存以下内容</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">#!/bin/bash</span><br><span class="line">while true; do</span><br><span class="line"></span><br><span class="line">str1=&quot;service frpc status&quot;</span><br><span class="line">str2=&quot;start proxy success&quot;</span><br><span class="line">result=$($str1 | grep &quot;$&#123;str2&#125;&quot;)</span><br><span class="line">if [[ &quot;$result&quot; != &quot;&quot; ]]</span><br><span class="line">then</span><br><span class="line">#    echo &quot;frpc 正在工作中...&quot;</span><br><span class="line">：</span><br><span class="line">else</span><br><span class="line">#    echo &quot;frpc 运行失败，正在重启...&quot;</span><br><span class="line">service frpc restart</span><br><span class="line">fi</span><br><span class="line">sleep 5</span><br><span class="line">done</span><br></pre></td></tr></table></figure><p>给它设置执行权限<br>chmod -x &#x2F;usr&#x2F;local&#x2F;frp&#x2F;frpcd.sh</p><p>启动试试<code>./frpcd.sh</code><br>你可以先停止frpc服务然后看看守护程序能否实现自动检测并重启frcp，通过以下三个命令。<br>service frpc stop #停止frpc服务<br>&#x2F;usr&#x2F;local&#x2F;frp&#x2F;frpcd.sh #启动frpcd守护<br>service frpc status #检查frpc服务状态<br>如果看到<code>proxy start success</code>就是成功了</p></div><h2 id="3-开机启动frpcd守护进程"><a href="#3-开机启动frpcd守护进程" class="headerlink" title="3. 开机启动frpcd守护进程"></a>3. 开机启动frpcd守护进程</h2><div class="story post-story"><p>创建一个systemctl文件</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nano /lib/systemd/system/frpcd.service</span><br></pre></td></tr></table></figure><p>保存以下内容</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">[Unit]</span><br><span class="line">Description=frpc daemon service</span><br><span class="line">After=network.target syslog.target</span><br><span class="line">Wants=network.target</span><br><span class="line">Requires=network-online.target</span><br><span class="line"></span><br><span class="line">[Service]</span><br><span class="line">Type=simple</span><br><span class="line">#启动服务的命令（此处写你的frps的实际安装目录）</span><br><span class="line">ExecStart=/usr/local/frp/frpcd.sh</span><br><span class="line">Restart=on-failure</span><br><span class="line">RestartSec=5s</span><br><span class="line">KillSignal=SIGQUIT</span><br><span class="line">TimeoutStopSec=5</span><br><span class="line">KillMode=process</span><br><span class="line">PrivateTmp=true</span><br><span class="line"></span><br><span class="line">[Install]</span><br><span class="line">WantedBy=multi-user.target</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>把守护进程设为开机启动<br><code>systemctl enable frpcd.service</code><br>最后别忘了重新加载systemctl服务<br><code>systemctl daemon-reload</code></p></div><h2 id="4-设置frps的注意事项"><a href="#4-设置frps的注意事项" class="headerlink" title="4. 设置frps的注意事项"></a>4. 设置frps的注意事项</h2><div class="story post-story"><p>frps服务器端也是同理，但是要注意systemctl的路径，尽量避免路径不准确造成的重定向反馈。用于锚定返回值的str2建议设为<code>running</code>更为合理，避免frps一直在重启从而导致连接失败的问题。</p></div><h2 id="5-reboot"><a href="#5-reboot" class="headerlink" title="5. reboot"></a>5. reboot</h2><div class="story post-story"><p>Ok，至此Frp已经完成了自我进化，再也不用担心它什么时候断掉了服务，当然你可以<code>reboot</code>来测试一下我的这套frp自我管理系统是否对你的小可爱奏效。</p></div>]]></content>
    
    
    <summary type="html">&lt;p&gt;&lt;img src=&quot;/images/2020/04/frp.png&quot;&gt;&lt;br&gt;一觉睡醒后发现树莓派上的博客无法访问了，通过检查日志找到了原因，原来是一向乖巧的frp服务被莫名中断，看起来它也有脆弱的一面呀。世间万物都在进化，是时候实现frp的自我管理了，让它可以在各种原因中断后自行检查并自行恢复。这篇文章记录了我是如何高效且快速创建一个frp全自动化守护进程的。&lt;/p&gt;</summary>
    
    
    
    <category term="网站" scheme="https://purel.in/categories/%E7%BD%91%E7%AB%99/"/>
    
    
    <category term="Frp" scheme="https://purel.in/tags/Frp/"/>
    
    <category term="树莓派" scheme="https://purel.in/tags/%E6%A0%91%E8%8E%93%E6%B4%BE/"/>
    
    <category term="守护进程" scheme="https://purel.in/tags/%E5%AE%88%E6%8A%A4%E8%BF%9B%E7%A8%8B/"/>
    
  </entry>
  
  <entry>
    <title>Hexo + Frp + iAWriter = Overclocked Blogger</title>
    <link href="https://purel.in/Hexo-Frp-iAWriter-Overclocked-Blogger/"/>
    <id>https://purel.in/Hexo-Frp-iAWriter-Overclocked-Blogger/</id>
    <published>2020-04-09T10:13:17.000Z</published>
    <updated>2020-04-09T10:13:17.000Z</updated>
    
    <content type="html"><![CDATA[<p><img src="/images/2020/04/hexo-index.png" class="lazyload" data-srcset="/images/2020/04/hexo-index.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="><br>这篇文章通过我的iPhone和iPad基于Markdown标准写作而成，并由Hexo生成纯静态网页发布在Github和我的树莓派上，通过甲骨文在首尔数据中心的服务器对树莓派进行Frp反向代理，最终实现加速访问。</p><span id="more"></span><h2 id="Less-is-more"><a href="#Less-is-more" class="headerlink" title="Less is more"></a>Less is more</h2><div class="story post-story"><p>抛弃臃肿的Wordpress迫在眉睫，博客作为一个专注于码字的工具越是精简越好，如此我们才能聚焦在脑海中每一个转瞬即逝的思绪中。</p><p>最早关注这类静态博客生成器是因为Github的码农们，我发现他们大部分博客都部署于Github的Pages，一个由Hexo或Hugo驱动的博客似乎成了“大佬”的标志。自从入手树莓派之后自己对于Linux环境也变得愈发熟悉，那么选择一款静态博客生成器并部署在树莓派上，再通过Frp反向代理让我随时随地都能访问、编辑和发布文章岂不是很有趣的一件事。既然想法有了，咱们说干就干吧。</p><p>市面上的静态博客生成器那么多，我到底该选哪一款呢，毕竟初衷是为了专注于写作这件事而不是来回折腾（打脸～）。</p></div><h2 id="Hexo-or-Hugo"><a href="#Hexo-or-Hugo" class="headerlink" title="Hexo or Hugo?"></a>Hexo or Hugo?</h2><div class="story post-story"><blockquote><p>困扰我们的不是没有选择，往往是因为选择太多。</p></blockquote><p>最终我在Hexo和Hugo中做出了选择，如果你去Google就会发现，几乎所有人都在从Hexo搬家到Hugo，因为Hugo基于Go语言使网页生成速度快到可以忽略不计，而Hexo的页面生成对于文章和页面众多的博客主来说就要花些时间，但这依然不妨碍我对Hexo的青睐，因为Hugo由一群搞后端的程序员们开发和维护，而Hexo则是由一群搞前端的设计师们簇拥的。</p><blockquote><p>赏心悦目绝不仅仅是因为表面的光鲜，而是与每个人的内在相互关联。<br>—Jacob Xu</p></blockquote></div><h2 id="Always-Online"><a href="#Always-Online" class="headerlink" title="Always Online"></a>Always Online</h2><div class="story post-story"><p>随时随地用iA Writer在iPad或iPhone上就可以轻松编辑Markdown文章，通过Samba实时同步连接到我的树莓派，这个我专属的微型云计算数据中心会透过Frp将文章发布到互联网上。当我携带这张只有信用卡大小的数据中心外出时，即便没有Wifi的情况下，比如我乘坐高铁或者公交出行时，我依然可以通过手机给树莓派的共享热点来发布文章。</p><p>如果乘坐飞机或者进入深山老林没有了任何网络和蜂窝信号该怎么办？这时候树莓派双Wifi中的一个就开始工作了，它可以作为AP热点开放一个5G共享网络给附近的人，人们通过这个私有网络依然可以协同办公，包括更新文章到Purel.in。</p></div>]]></content>
    
    
    <summary type="html">&lt;p&gt;&lt;img src=&quot;/images/2020/04/hexo-index.png&quot;&gt;&lt;br&gt;这篇文章通过我的iPhone和iPad基于Markdown标准写作而成，并由Hexo生成纯静态网页发布在Github和我的树莓派上，通过甲骨文在首尔数据中心的服务器对树莓派进行Frp反向代理，最终实现加速访问。&lt;/p&gt;</summary>
    
    
    
    <category term="网站" scheme="https://purel.in/categories/%E7%BD%91%E7%AB%99/"/>
    
    
    <category term="Purel.in" scheme="https://purel.in/tags/Purel-in/"/>
    
    <category term="Hexo" scheme="https://purel.in/tags/Hexo/"/>
    
    <category term="Markdown" scheme="https://purel.in/tags/Markdown/"/>
    
    <category term="Blog" scheme="https://purel.in/tags/Blog/"/>
    
    <category term="树莓派" scheme="https://purel.in/tags/%E6%A0%91%E8%8E%93%E6%B4%BE/"/>
    
    <category term="iA Writer" scheme="https://purel.in/tags/iA-Writer/"/>
    
    <category term="Samba" scheme="https://purel.in/tags/Samba/"/>
    
  </entry>
  
  <entry>
    <title>树莓派：安装rtl8812bu双频无线网卡驱动</title>
    <link href="https://purel.in/raspberry-pi-install-rtl8812bu-dual-band-wireless-network-card-driver/"/>
    <id>https://purel.in/raspberry-pi-install-rtl8812bu-dual-band-wireless-network-card-driver/</id>
    <published>2020-04-03T21:49:36.000Z</published>
    <updated>2020-04-03T21:49:36.000Z</updated>
    
    <content type="html"><![CDATA[<p><img src="/images/2020/04/ac1200.jpg" class="lazyload" data-srcset="/images/2020/04/ac1200.jpg" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="><br>突发奇想，可不可以将Pi作为一个无线中继，转发5G的WIFI信号并共享给所有连接到它的设备呢？说干就干吧，第一步先从搭配硬件环境开始。</p><span id="more"></span><h2 id="1-选择无线网卡"><a href="#1-选择无线网卡" class="headerlink" title="1. 选择无线网卡"></a>1. 选择无线网卡</h2><div class="story post-story"><p>树莓派本身是千兆以太网口，以及5G&#x2F;2.4G双频WIFI无线网卡，但是要让它彻底作为无线中继，那个前兆以太网口就不用了，取而代之的是需要另一块无线WIFI，为了使网络带宽最大化被利用起来，我需要一款双频的无线网卡。</p><p><img src="/images/2020/04/ac1200m.jpg" class="lazyload" data-srcset="/images/2020/04/ac1200m.jpg" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" title="rtl8812bu"></p><p>在淘宝看了很久，最终选择了一款超级迷你款的rtl8812bu芯片作为双频发射端，客服说是出口外贸的商品，这款和ASUS的AC53很像，功能上基本一致，但是增加了USB3.0接口，这样能让5G的WIFI网速最大限度跑起来，目前大部分5G无线网卡还都是USB2.0接口，并且个头比较大插在Pi上面很突兀，这也是经常被我们忽略的部分。</p><p>理论上所有rtl8812bu芯片都可以在树莓派或者linux上安装驱动，但我还是废了一些周折，因为之前rpi-update升级了kernel内核，于是初次安装rtl8812bu驱动无法正常工作，现在写一下正确安装方法。</p></div><h2 id="2-卸载旧驱动"><a href="#2-卸载旧驱动" class="headerlink" title="2. 卸载旧驱动"></a>2. 卸载旧驱动</h2><div class="story post-story"><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ls /lib/modules/*/build -la #查看所有已经建立的驱动模块</span><br><span class="line">dkms uninstall -m rtl88x2bu -v 5.6.1 # 卸载驱动模块</span><br><span class="line">rpi-update # 升级内核到最新版，也可以跳过</span><br><span class="line">rpi-source # 构建正在运行的最新内核的源代码</span><br></pre></td></tr></table></figure></div><h2 id="3-安装rtl8812bu驱动"><a href="#3-安装rtl8812bu驱动" class="headerlink" title="3. 安装rtl8812bu驱动"></a>3. 安装rtl8812bu驱动</h2><div class="story post-story"><p><code>git clone https://github.com/cilynx/rtl88x2bu</code> #下载驱动<br>如果配置了代理，通过proxychains指令代理下载会更快，<a href="https://purel.in/raspberry-pi-quantum-cloud-lab-in-your-pocket-software/">可以参照我前面的文章来设置代理。</a></p></div><h2 id="4-树莓派安装步骤"><a href="#4-树莓派安装步骤" class="headerlink" title="4. 树莓派安装步骤"></a>4. 树莓派安装步骤</h2><div class="story post-story"><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"># Update all packages per normal</span><br><span class="line">sudo apt update</span><br><span class="line">sudo apt upgrade</span><br><span class="line"></span><br><span class="line"># Install prereqs</span><br><span class="line">sudo apt install git dnsmasq hostapd bc build-essential dkms raspberrypi-kernel-headers</span><br><span class="line"></span><br><span class="line"># Reboot just in case there were any kernel updates</span><br><span class="line">sudo reboot</span><br><span class="line"></span><br><span class="line"># Pull down the driver source</span><br><span class="line">git clone https://github.com/cilynx/rtl88x2bu</span><br><span class="line">cd rtl88x2bu/</span><br><span class="line"></span><br><span class="line"># Configure for RasPi</span><br><span class="line">sed -i &#x27;s/I386_PC = y/I386_PC = n/&#x27; Makefile</span><br><span class="line">sed -i &#x27;s/ARM_RPI = n/ARM_RPI = y/&#x27; Makefile</span><br><span class="line"></span><br><span class="line"># DKMS as above</span><br><span class="line">VER=$(sed -n &#x27;s/\PACKAGE_VERSION=\(.*\)/\1/p&#x27; dkms.conf)</span><br><span class="line">sudo rsync -rvhP ./ /usr/src/rtl88x2bu-$&#123;VER&#125;</span><br><span class="line">sudo dkms add -m rtl88x2bu -v $&#123;VER&#125;</span><br><span class="line">sudo dkms build -m rtl88x2bu -v $&#123;VER&#125; # Takes ~3-minutes on a 3B+</span><br><span class="line">sudo dkms install -m rtl88x2bu -v $&#123;VER&#125;</span><br><span class="line"></span><br><span class="line"># Plug in your adapter then confirm your new interface name</span><br><span class="line">ip addr</span><br></pre></td></tr></table></figure><p>最后敲入<code>lsmod</code>看到88x2bu赫然在列，完美。<br>至此，我的rtl88x2bu无线双频网卡已经可以使用了～</p></div>]]></content>
    
    
    <summary type="html">&lt;p&gt;&lt;img src=&quot;/images/2020/04/ac1200.jpg&quot;&gt;&lt;br&gt;突发奇想，可不可以将Pi作为一个无线中继，转发5G的WIFI信号并共享给所有连接到它的设备呢？说干就干吧，第一步先从搭配硬件环境开始。&lt;/p&gt;</summary>
    
    
    
    <category term="树梅派" scheme="https://purel.in/categories/%E6%A0%91%E6%A2%85%E6%B4%BE/"/>
    
    
    <category term="树梅派" scheme="https://purel.in/tags/%E6%A0%91%E6%A2%85%E6%B4%BE/"/>
    
    <category term="Pi" scheme="https://purel.in/tags/Pi/"/>
    
    <category term="驱动" scheme="https://purel.in/tags/%E9%A9%B1%E5%8A%A8/"/>
    
    <category term="无线网卡" scheme="https://purel.in/tags/%E6%97%A0%E7%BA%BF%E7%BD%91%E5%8D%A1/"/>
    
    <category term="rtl8812bu" scheme="https://purel.in/tags/rtl8812bu/"/>
    
  </entry>
  
  <entry>
    <title>树莓派：安装0.96寸SPI接口SSD1306屏幕</title>
    <link href="https://purel.in/raspberry-pi-install-0-96-inch-spi-interface-ssd1306-screen/"/>
    <id>https://purel.in/raspberry-pi-install-0-96-inch-spi-interface-ssd1306-screen/</id>
    <published>2020-04-03T21:48:32.000Z</published>
    <updated>2020-04-03T21:48:32.000Z</updated>
    
    <content type="html"><![CDATA[<p><img src="/images/2020/04/spi-night.jpg" class="lazyload" data-srcset="/images/2020/04/spi-night.jpg" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="><br>当这块小屏幕在夜里散发着光芒，你看到它便能回忆起整个部署的过程……</p><span id="more"></span><h2 id="1-硬件的选配"><a href="#1-硬件的选配" class="headerlink" title="1. 硬件的选配"></a>1. 硬件的选配</h2><div class="story post-story"><p>淘宝搜索ssd1306 spi选一家十块钱左右有眼缘的，为什么选择spi的7针而不是i2c简单的4针呢？因为i2c刷新率只有10fps，而spi高达64-364fps。然后再加1.5元买40根杜邦线，虽然用不了这么多，但是为了以后扩展GPIO接口做备胎，然后apt-get安装Adafruit的1306库，对example代码稍事调整，然后在cmd输入一条python指令成功点亮….</p></div><h2 id="2-连接GPIO排线"><a href="#2-连接GPIO排线" class="headerlink" title="2. 连接GPIO排线"></a>2. 连接GPIO排线</h2><div class="story post-story"><p>ls &#x2F;dev&#x2F;spidev* #如果目录为空，可能之前安装过spi屏幕占用了接口，正常应该显示 &#x2F;dev&#x2F;spidev0.0 &#x2F;dev&#x2F;spidev0.1 查看config.txt文件是否有dtoverlay开头的命令，如果有就加#注释掉。还可以通过lsmod #查看是否开启了spi模块。</p><p><img src="https://purel.in/wp-content/uploads/2020/04/spi.bmp" class="lazyload" data-srcset="https://purel.in/wp-content/uploads/2020/04/spi.bmp" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==">把模块的引脚接到树莓派的GPIO上， 需要注意这里要分清GPIO引脚号是BCM编号还是实际编号。GND脚和树莓派的GND连接；VCC接到3.3V脚；D0接到树莓派的SCLK脚（第23号脚），即BCM.11脚；D1接到MOSI脚（第19号脚），即BCM.10；RES接到BCM.17脚，即第11号脚；DC接到BCM.22脚，即第15号脚；CS接到CE0脚（第24号脚）。总之，除了RES和DC是可以任意指定GPIO口，其他引脚是必须和树莓派上的指定脚连接的。</p></div><h2 id="3-安装软件"><a href="#3-安装软件" class="headerlink" title="3. 安装软件"></a>3. 安装软件</h2><div class="story post-story"><h4 id="3-1-安装ssd1306库"><a href="#3-1-安装ssd1306库" class="headerlink" title="3.1 安装ssd1306库"></a>3.1 安装ssd1306库</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install git</span><br><span class="line">git clone https://github.com/adafruit/Adafruit_Python_SSD1306.git</span><br><span class="line">cd Adafruit_Python_SSD1306</span><br><span class="line">sudo python setup.py install</span><br></pre></td></tr></table></figure><h4 id="3-2-创建一个py文件"><a href="#3-2-创建一个py文件" class="headerlink" title="3.2 创建一个py文件"></a>3.2 创建一个py文件</h4><p>我希望用这块屏幕显示本机IP地址&#x2F;CPU内存&#x2F;磁盘使用情况，用以下代码创建一个文件命名为sys_info.py。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line">import time</span><br><span class="line">import Adafruit_GPIO.SPI as SPI</span><br><span class="line">import Adafruit_SSD1306</span><br><span class="line">from PIL import Image</span><br><span class="line">from PIL import ImageDraw</span><br><span class="line">from PIL import ImageFont</span><br><span class="line">import subprocess</span><br><span class="line"></span><br><span class="line"># Raspberry Pi pin configuration:</span><br><span class="line">RST = 17     # 注意这里填BCM标准的针脚号</span><br><span class="line"># Note the following are only used with SPI:</span><br><span class="line">DC = 22</span><br><span class="line">SPI_PORT = 0</span><br><span class="line">SPI_DEVICE = 0</span><br><span class="line"></span><br><span class="line"># 128x64 display with hardware SPI:</span><br><span class="line">disp = Adafruit_SSD1306.SSD1306_128_64(rst=RST, dc=DC, spi=SPI.SpiDev(SPI_PORT, SPI_DEVICE, max_speed_hz=8000000))</span><br><span class="line"></span><br><span class="line"># Initialize library.</span><br><span class="line">disp.begin()</span><br><span class="line"></span><br><span class="line"># Clear display.</span><br><span class="line">disp.clear()</span><br><span class="line">disp.display()</span><br><span class="line"></span><br><span class="line"># Create blank image for drawing.</span><br><span class="line"># Make sure to create image with mode &#x27;1&#x27; for 1-bit color.</span><br><span class="line">width = disp.width</span><br><span class="line">height = disp.height</span><br><span class="line">image = Image.new(&#x27;1&#x27;, (width, height))</span><br><span class="line"></span><br><span class="line"># Get drawing object to draw on image.</span><br><span class="line">draw = ImageDraw.Draw(image)</span><br><span class="line"></span><br><span class="line"># Draw a black filled box to clear the image.</span><br><span class="line">draw.rectangle((0,0,width,height), outline=0, fill=0)</span><br><span class="line"></span><br><span class="line"># Draw some shapes.</span><br><span class="line"># First define some constants to allow easy resizing of shapes.</span><br><span class="line">padding = -2</span><br><span class="line">top = padding</span><br><span class="line">bottom = height-padding</span><br><span class="line"># Move left to right keeping track of the current x position for drawing shapes.</span><br><span class="line">x = 0</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># Load default font.</span><br><span class="line">font = ImageFont.load_default()</span><br><span class="line"></span><br><span class="line"># Alternatively load a TTF font.  Make sure the .ttf font file is in the same directory as the python script!</span><br><span class="line"># Some other nice fonts to try: http://www.dafont.com/bitmap.php</span><br><span class="line"># font = ImageFont.truetype(&#x27;Minecraftia.ttf&#x27;, 8)</span><br><span class="line"></span><br><span class="line">while True:</span><br><span class="line"></span><br><span class="line">    # Draw a black filled box to clear the image.</span><br><span class="line">    draw.rectangle((0,0,width,height), outline=0, fill=0)</span><br><span class="line"></span><br><span class="line">    # Shell scripts for system monitoring from here : https://unix.stackexchange.com/questions/119126/command-to-display-memory-usage-disk-usage-and-cpu-load</span><br><span class="line">    cmd = hostname -I | cut -d\&#x27; \&#x27; -f1</span><br><span class="line">    IP = subprocess.check_output(cmd, shell = True )</span><br><span class="line">    cmd = top -bn1 | grep load | awk &#x27;&#123;printf \CPU: %.2f\, $(NF-2)&#125;&#x27;</span><br><span class="line">    CPU = subprocess.check_output(cmd, shell = True )</span><br><span class="line">    cmd = free -m | awk &#x27;NR==2&#123;printf \Mem: %s/%sMB %.2f%%\, $3,$2,$3*100/$2 &#125;&#x27;</span><br><span class="line">    MemUsage = subprocess.check_output(cmd, shell = True )</span><br><span class="line">    cmd = df -h | awk &#x27;$NF==\/\&#123;printf \Disk: %d/%dGB %s\, $3,$2,$5&#125;&#x27;</span><br><span class="line">    Disk = subprocess.check_output(cmd, shell = True )</span><br><span class="line">    cmd = vcgencmd measure_temp</span><br><span class="line">    Temp = subprocess.check_output(cmd, shell = True )</span><br><span class="line"></span><br><span class="line">  # Return CPU temperature as a character string</span><br><span class="line"></span><br><span class="line">    # Write two lines of text.</span><br><span class="line"></span><br><span class="line">    draw.text((x, top),       IP:  + str(IP),  font=font, fill=255)</span><br><span class="line">    draw.text((x, top+9),     str(CPU), font=font, fill=255)</span><br><span class="line">    draw.text((x, top+18),    str(MemUsage),  font=font, fill=255)</span><br><span class="line">    draw.text((x, top+27),    str(Disk),  font=font, fill=255)</span><br><span class="line">    draw.text((60, top+9),    str(Temp), font=font, fill=255)</span><br><span class="line"></span><br><span class="line">    # Display image.</span><br><span class="line">    disp.image(image)</span><br><span class="line">    disp.display()</span><br><span class="line"># 设置屏幕刷新间隔秒数，与CPU损耗相关</span><br><span class="line">    time.sleep(5)</span><br></pre></td></tr></table></figure><p>通过 <code>python sys_info.py</code> 运行它，如果提示却什么模块可以直接安装再执行，比如我这边缺了utmp模块，输入 <code>apt-get install python-utmp</code> 来进行安装。</p><p>再次运行python sys_info.py成功点亮～<br>这里值得注意的是<code>time.sleep(5)</code>参数，起初的demo值默认为<code>.1</code>，这意味着每0.1秒就刷新一次屏幕，不管我是否注释掉这一行CPU负载都会迅速提升。所以我的建议值是5秒，这足够我们获取到刷新的信息而不烦躁，并且有效降低树莓派的CPU复杂。</p><p><img src="/images/2020/04/sys_info.jpg" class="lazyload" data-srcset="/images/2020/04/sys_info.jpg" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" title="Processed with VSCO with a8 preset"></p></div><h2 id="4-设置开机启动"><a href="#4-设置开机启动" class="headerlink" title="4. 设置开机启动"></a>4. 设置开机启动</h2><div class="story post-story"><p>进入目录 &#x2F;lib&#x2F;systemd&#x2F;system 创建<code>sys_info.service</code>文件</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[Unit]</span><br><span class="line">Description=sys——info service</span><br><span class="line">After=network.target syslog.target</span><br><span class="line">Wants=network.target</span><br><span class="line">[Service]</span><br><span class="line">Type=simple</span><br><span class="line">启动服务的命令（此处写你的frps的实际安装目录）</span><br><span class="line">ExecStart=python /root/sys_info.py</span><br><span class="line">[Install]</span><br><span class="line">WantedBy=multi-user.target`</span><br></pre></td></tr></table></figure><h4 id="4-1-启动-sys-info"><a href="#4-1-启动-sys-info" class="headerlink" title="4.1 启动 sys_info"></a>4.1 启动 sys_info</h4><p><code>sudo systemctl start sys_info</code></p><h4 id="4-1-设为开机自启动"><a href="#4-1-设为开机自启动" class="headerlink" title="4.1 设为开机自启动"></a>4.1 设为开机自启动</h4><p><code>sudo systemctl enable sys_info</code></p></div>]]></content>
    
    
    <summary type="html">&lt;p&gt;&lt;img src=&quot;/images/2020/04/spi-night.jpg&quot;&gt;&lt;br&gt;当这块小屏幕在夜里散发着光芒，你看到它便能回忆起整个部署的过程……&lt;/p&gt;</summary>
    
    
    
    <category term="树梅派" scheme="https://purel.in/categories/%E6%A0%91%E6%A2%85%E6%B4%BE/"/>
    
    
    <category term="树梅派" scheme="https://purel.in/tags/%E6%A0%91%E6%A2%85%E6%B4%BE/"/>
    
    <category term="ssd1306" scheme="https://purel.in/tags/ssd1306/"/>
    
    <category term="LCD" scheme="https://purel.in/tags/LCD/"/>
    
    <category term="SPI" scheme="https://purel.in/tags/SPI/"/>
    
    <category term="Pi" scheme="https://purel.in/tags/Pi/"/>
    
    <category term="Python" scheme="https://purel.in/tags/Python/"/>
    
    <category term="驱动" scheme="https://purel.in/tags/%E9%A9%B1%E5%8A%A8/"/>
    
  </entry>
  
  <entry>
    <title>树莓派：装在口袋里的量子云实验室（软件篇）</title>
    <link href="https://purel.in/raspberry-pi-quantum-cloud-lab-in-your-pocket-software/"/>
    <id>https://purel.in/raspberry-pi-quantum-cloud-lab-in-your-pocket-software/</id>
    <published>2020-03-19T00:11:56.000Z</published>
    <updated>2020-03-19T00:11:56.000Z</updated>
    
    <content type="html"><![CDATA[<p><img src="/images/2020/03/IMG_2391-scaled.jpg" class="lazyload" data-srcset="/images/2020/03/IMG_2391-scaled.jpg" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="alt text" title="Title"><br>小的时候父母工作很忙，经常把我一个人留在家里，那个时候的杀手锏就是玩具。因为我可以一直玩一整天，完全沉浸其中忘记时间。</p><span id="more"></span><h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>那时候父母工作很忙经常把我一个人留在家里，但我一点也不觉得孤独，因为我有各式各样的玩具陪伴。每次父母出差回家都会给我带新的玩具，所以我跟其他小朋友最大的不同就是我总期待父母出差，因为这意味着我又会有新的玩具了。玩具总能令我发散思维并启发探索精神，似乎通过它们可以打开生命和宇宙的无限可能。</p><p>Raspberry Pi 帮我找回了这种感觉，作为开发板它小小的身躯并不能跟各个商售的电脑比拼性能，但是却从物联网领域给了我们更多的想象空间，这正是这个世界未来的趋势。</p><p>抛开华丽的图形界面拥抱Linux指令，让自己融入一种全新的语言环境，这种语言环境甚至会改变大脑的思维方式。当你越了解了计算机语言就越会发现除了吃喝拉撒睡以外，人和计算机并没有什么本质的区别，当然计算机还摆脱了妄想、分别和执念……</p><h2 id="1-启动"><a href="#1-启动" class="headerlink" title="1.启动"></a>1.启动</h2><div class="story post-story"><p>最终我还是把3.5寸触摸屏摘掉了，因为是在没什么用，并且会导致整台机器发热量很大，摘掉屏幕后清爽了很多，这是Pi本该有的样子～</p><p>首先让我们从配置WIFI开始，SD卡根目录下新建一个名为<code>wpa_supplicant.conf</code>的文件：<br><code>sudo nano /Volumes/boot/wpa_supplicant.conf</code></p><h4 id="写入WIFI配置"><a href="#写入WIFI配置" class="headerlink" title="写入WIFI配置"></a>写入WIFI配置</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">country=CN #如果非CN国家代码可能导致5G-Wifi不能被识别</span><br><span class="line">ctrl_interface=DIR=/var/run/wpa_supplicant GROUP=netdev</span><br><span class="line">update_config=1</span><br><span class="line">network=&#123;</span><br><span class="line">ssid=&lt;YOUR-NETWORK-NAME&gt;</span><br><span class="line">psk=&lt;YOUR-NETWORK-PASSWORD&gt;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="开启SSH"><a href="#开启SSH" class="headerlink" title="开启SSH"></a>开启SSH</h4><p>只需在SD卡根目录下新建一个名为ssh的空文件：<br><code>nano /Volumes/boot/ssh</code><br>在Macbookl登录树莓派的ssh时遇到了密钥冲突，<br>输入<code>ssh-keygen -R 192.168.1.121</code>清空之前该IP地址储存在本机的密钥。</p><p>第一次用<code>pi</code>登录后默认密码为<code>raspberry</code>，应使用<code>sudo raspi-config</code>通过树莓派管理工具修改密码、主机名等信息，或是直接使用<code>passwd</code>修改密码。我是直接开启了root权限<code>sudo passwd root</code>然后切换为root用户<code>su root</code>。</p><h4 id="允许ROOT权限远程登录"><a href="#允许ROOT权限远程登录" class="headerlink" title="允许ROOT权限远程登录"></a>允许ROOT权限远程登录</h4><p><code>sudo nano /etc/ssh/sshd_config</code><br>找到 <code>PermitRootLogin without-password</code> 前面加<code>#</code>注释掉，在下面添加<code>PermitRootLogin yes</code> 然后通过 <code>service ssh restart</code> 重启ssh服务生效。</p></div><h2 id="2-环境部署"><a href="#2-环境部署" class="headerlink" title="2.环境部署"></a>2.环境部署</h2><div class="story post-story"><p>无论是人还是机器，只有部署在合适的环境才能够发挥最大的生产力。</p><h4 id="最适合树莓派的系统"><a href="#最适合树莓派的系统" class="headerlink" title="最适合树莓派的系统"></a>最适合树莓派的系统</h4><p>唯一让我纠结的是Raspbian这个64位的cpu却跑着32位系统，意味着Pi的性能大打折扣，于是开始探索在Pi上装64位Ubuntu的可能性，目前官方只给出了Server版，但这就意味着我必须手动安装图形桌面，事实证明官方的Raspbian就是最合适的，树莓派的工程师在论坛给出了切换kernel到64 bit内核的临时方案用于测试，不过这又牵扯到在终端使用<code>rpi-update</code>命令来更新系统环境。输入<code>uname -a</code>会得到以下信息：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Linux pi 4.19.108-v7l+ #1298 SMP Fri Mar 6 18:09:54 GMT 2020 armv7l GNU/Linux</span><br></pre></td></tr></table></figure><p>通过<code>rpi-update</code>更新后在&#x2F;boot&#x2F;config.txt中加入<code>arm_64bit=1</code>可以切换内核到64版本，再开机时输入<code>uname -a</code> 得到<code>aarch64</code>。这个方法可以临时装一下64位的程序，不过我安装最新版本的宝塔面板仍人提示不支持32位版本而失败……</p><p>这一周对于私有云的部署让我重新找到小时候的感觉，光是切换到不同的系统去体验Linux就花费了两天时间，最终还是确定用Raspbian原版系统。绕了一大圈回到原点的过程确实是必要的，它会让我知道什么是重要的，什么是需要的，以及各个系统的优势劣势。</p><h4 id="部署LNMP网站环境"><a href="#部署LNMP网站环境" class="headerlink" title="部署LNMP网站环境"></a>部署LNMP网站环境</h4><p>环境安装的是Nginx+Mysql+Php7.3，从安装到运行都没出现任何问题，LNMP适合我对网站部署的全部需求。这是一套非常成熟的环境，推荐使用OneInStack一键部署lnmp环境指令。打开<a href="https://oneinstack.com/auto/">OneInStack官方网站</a>自定义自己的一键部署指令非常方便。</p></div><h2 id="3-部署量子云实验室"><a href="#3-部署量子云实验室" class="headerlink" title="3.部署量子云实验室"></a>3.部署量子云实验室</h2><div class="story post-story"><h4 id="Nextcloud部署"><a href="#Nextcloud部署" class="headerlink" title="Nextcloud部署"></a>Nextcloud部署</h4><p>Nextcloud的安装没什么好记录的，之前在韩国服务器使用自动官方的安装文件setup-nextcloud.php顺利一键搞定，但由于网络原因在树莓派这样行不通，于是下载了最新版本解压安装的，依然比较顺利，除了要注意nextcloud所在目录的用户和用户组权限问题，在参阅了ngnix.conf文件后确认了ngnix的默认用户和用户组是<code>www-data</code>，于是修改了在root下创建的nextcloud目录权限后可以完美运行。</p><p>使用过程中偶尔会出现502 Bad Gateway的错误提示，只有重启才能修复，于是想干脆升级到php7.4试试看。但是当升级之后发现nextcloud提示Internet Server 500错误无法打开，直觉告诉我将config.php文件修改为config1.php会得到真正信息，果然再刷新页面提示未安装php dom模块，于是敲入<code> sudo apt-get install php-xml</code>解决～</p><p>关于nextcloud后台<strong>安全与设置警告</strong>检测出来的一些问题，逐一Google即可解决，比如<code>在数据表 oc_calendarobjects_props 中无法找到索引 calendarobject_calid_index。</code><br>通过SSH输入下面代码解决。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo -u www-data php occ db:add-missing-indices</span><br></pre></td></tr></table></figure><p>其他的警告处理起来也是同理。关于nginx、php-fpm以及mysql的配置文件方面需要多多参考官方建议进行配置。</p><h4 id="挂载移动硬盘"><a href="#挂载移动硬盘" class="headerlink" title="挂载移动硬盘"></a>挂载移动硬盘</h4><p>挂载外接硬盘出现了一个小插曲，确实应该记录下来。<br>为了打造私有云盘，我需要更大的存储空间，于是利用之前一直吃灰的1T移动硬盘作为外部挂载。<br>通过<code>fdisk -l</code> 指令检查发现我的1T硬盘挂在&#x2F;dev&#x2F;sda2的位置，于是通过如下指令进行重新挂载。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mkdir /media/lab #在media目录下创建lab目录</span><br><span class="line">umount /dev/sda2 #卸载移动硬盘</span><br><span class="line">mount /dev/sda2 /media/lab #重新挂载到刚刚创建的lab目录</span><br></pre></td></tr></table></figure><p>现在它挂载到了<code>/media/lab</code>，这样便可以在nextcloud中作为外部存储添加使用了。</p><h4 id="格式化移动硬盘到Ext4"><a href="#格式化移动硬盘到Ext4" class="headerlink" title="格式化移动硬盘到Ext4"></a>格式化移动硬盘到Ext4</h4><p>先查看UUID<code>sudo blkid</code> 然后格式化为Linux的格式</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo mkfs.ext4 /dev/sda</span><br></pre></td></tr></table></figure><p>linux下的格式普遍为<code>ext2</code>、<code>ext3</code>和<code>ext4</code>，并且版本高的可以向下兼容，这里我选择<code>ext4</code>，<br>之前也考虑用Windows的Fat或者MacOS的NTFS，但是发现在Pi下面接Nextcloud无法顺利使用，<br>好在Ext4在其他系统中也都有很好的识别办法，比如通过下载相应的软件实现。</p><p><img src="/images/2020/03/7552A5D8.jpeg" class="lazyload" data-srcset="/images/2020/03/7552A5D8.jpeg" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" title="blood &amp; etc/fstab"></p><p>为了让它开机自动挂载，而不是挂载到某个用户文件夹下，需要修改<code>/etc/fstab</code>文件，<br>但是由于误把PARTUUID当作UUID使用，而且设置了开机自检造成无法开机，这就是拿别人代码不检查就用所付出的代价。<br>于是拔出SD卡插入我的Macbook在&#x2F;cmdlIne.txt中最后一行加入<code>“ S”</code>，再次重启顺利进入维护模式。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dwc_otg.lpm_enable=0 console=serial0,115200 console=tty1 root=/dev/mmcblk0p2 rootfstype=ext4 elevator=deadline fsck.repair=yes rootwait S</span><br></pre></td></tr></table></figure><p>回到熟悉的命令行重新<code>sudo nano /etc/fstab</code>加入了正确的指令是这样子的，中间的空格可以随意增减但是必须要有。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">UUID=c690611e-42cc-471d-bbab-f718c8961014 /media/disk ext4 defaults 0 0</span><br></pre></td></tr></table></figure><p>这里备注一下,后面两个0第一个代表dump即不备份。第二个代表fsck检查的顺序0表示不检查，跳过开机检查避免不必要的麻烦。</p></div><h2 id="4-科学上网"><a href="#4-科学上网" class="headerlink" title="4.科学上网"></a>4.科学上网</h2><div class="story post-story"><p>互联网将人们的学习能力提升了N级，我们与知识之间最近的距离就是Google一下。在国内完全没有可替代的环境，作为Google、Youtube、Netflix的重度使用患者，让自己的派科学上网是非常必要的，这是与世界连接的第一步，就像是学习英文可以帮助我们更好的理解这个世界是一样的道理。</p><h4 id="树莓派部署酸酸乳"><a href="#树莓派部署酸酸乳" class="headerlink" title="树莓派部署酸酸乳"></a>树莓派部署酸酸乳</h4><p>首先确认一下自己自己安装了Git。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install git #ubuntu</span><br><span class="line">sudo yum install git #CentOS</span><br></pre></td></tr></table></figure><p>然后在具有写权限的目录执行如下命令获取到ssr脚本仓库<br><code>git clone http://git.mrwang.pw/Reed/Linux_ssr_script.git</code><br>进入刚刚克隆的仓库目录并赋予ssr脚本执行权限<br><code>cd Linux_ssr_script &amp;&amp; chmod +x ./ssr</code><br>然后将脚本放入可执行脚本的目录，这样就完成了脚本的安装<br><code>sudo mv ./ssr /usr/local/sbin/</code><br>使用时只需要输入<code>ssr</code>就会看到支持的命令列表。输入<code>ssr config</code>开始配置ssr。<br>我使用的是韩国服务器，不差钱的朋友也可以根据自己需求购置云VPS部署酸酸乳服务端。</p><h4 id="部署ProxyChains代理指定程序"><a href="#部署ProxyChains代理指定程序" class="headerlink" title="部署ProxyChains代理指定程序"></a>部署ProxyChains代理指定程序</h4><p>ProxyChains是一个使用方便的代理工具，它只会代理指定的程序。<br>下载：<br><code>git clone https://github.com/rofl0r/proxychains-ng</code><br>安装：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">cd proxychains-ng/</span><br><span class="line">./configure --prefix=/usr --sysconfdir=/etc</span><br><span class="line">make</span><br><span class="line">sudo make install</span><br><span class="line">sudo make install-config</span><br></pre></td></tr></table></figure><p>配置：<br>将<code>/etc/proxychains.conf</code>最后一行修改为酸酸乳端口：<code>socks5 127.0.0.1 1080</code>，测试<code>wget</code>，返回网页源码：<code>proxychains4 wget -qO- https://www.google.com</code></p><h4 id="http代理"><a href="#http代理" class="headerlink" title="http代理"></a>http代理</h4><p>有些程序并不像<code>curl</code>那样能够直接支持socks5代理，有时，按照情况需要配置http代理。<br>安装<code>privoxy</code>，开启全局http代理，其默认代理地址为<code>http://127.0.0.1:8118</code>：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install privoxy</span><br><span class="line">sudo -s</span><br><span class="line">echo &#x27;forward-socks5 / 127.0.0.1:1080 .&#x27; &gt;&gt;/etc/privoxy/config</span><br><span class="line">systemctl status privoxy.service #查看代理状态</span><br><span class="line">systemctl enable privoxy.service #开机自动启动</span><br><span class="line">systemctl start privoxy.service #开启http代理`</span><br><span class="line">systemctl restart privoxy.service #重启http代理</span><br></pre></td></tr></table></figure><p>测试http代理：<code>wget -qO- -e use_proxy=yes -e http_proxy=127.0.0.1:8118 http://google.com</code><br>我一般是配合sudo apt指令使用，特别是rpi-update，通过http代理可以很好的实现更新加速。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sudo http_proxy=http://127.0.0.1:8118 apt-get update</span><br><span class="line">sudo http_proxy=http://127.0.0.1:8118 apt-get upgrade</span><br><span class="line">sudo http_proxy=http://127.0.0.1:8118 apt-get dist-upgrade</span><br><span class="line">sudo http_proxy=http://127.0.0.1:8118 rpi-update</span><br></pre></td></tr></table></figure></div><h2 id="5-FRP内网穿透"><a href="#5-FRP内网穿透" class="headerlink" title="5.FRP内网穿透"></a>5.FRP内网穿透</h2><div class="story post-story"><p>如果有一对带电粒子相互间量子纠缠，一个在地球而另一个被发射到月球，这两个粒子因量子纠缠效应会完全同步。FRP就是这样一个工具，它帮助我们实现通过互联网直接访问本地主机的网站或资源。安装与配置直接采用<a href="https://github.com/fatedier/frp/blob/master/README_zh.md">官方指南</a>，非常明晰。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://github.com/fatedier/frp/blob/master/README_zh.md</span><br></pre></td></tr></table></figure><h4 id="开机自动启动FRP"><a href="#开机自动启动FRP" class="headerlink" title="开机自动启动FRP"></a>开机自动启动FRP</h4><p><code>sudo nano /lib/systemd/system/frps.service </code><br>填入以下代码并Ctrl+O保存，Ctrl+X退出</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[Unit]</span><br><span class="line">Description=frapc service</span><br><span class="line">After=network.target syslog.target</span><br><span class="line">Wants=network.target</span><br><span class="line">[Service]</span><br><span class="line">Type=simple</span><br><span class="line">ExecStart=/your/path/frpc -c /your/path/frpc.ini</span><br><span class="line">[Install]</span><br><span class="line">WantedBy=multi-user.target</span><br></pre></td></tr></table></figure><p>然后就启动frpc，输入<code>sudo systemctl start frpc</code><br>再打开自启动，输入<code>sudo systemctl enable frpc</code></p><p>如果要重启应用，可以这样，<code>sudo systemctl restart frpc</code><br>如果要停止应用，可以输入，<code>sudo systemctl stop frpc</code><br>如果要查看应用的日志，可以输入，<code>sudo systemctl status frpc</code><br>这里是以本地树莓派frpc做例子，远程服务器的frps同理。</p><p>先写这么多，后面想到什么在慢慢补充……<br>如果你对树莓派感兴趣，<a href="https://purel.in/raspberry-pi-quantum-cloud-lab-in-your-pocket-hardware/">可以阅读我的上一篇文章，关于它的硬件部署。</a></p></div>]]></content>
    
    
    <summary type="html">&lt;p&gt;&lt;img src=&quot;/images/2020/03/IMG_2391-scaled.jpg&quot; alt=&quot;alt text&quot; title=&quot;Title&quot;&gt;&lt;br&gt;小的时候父母工作很忙，经常把我一个人留在家里，那个时候的杀手锏就是玩具。因为我可以一直玩一整天，完全沉浸其中忘记时间。&lt;/p&gt;</summary>
    
    
    
    <category term="树梅派" scheme="https://purel.in/categories/%E6%A0%91%E6%A2%85%E6%B4%BE/"/>
    
    
    <category term="树梅派" scheme="https://purel.in/tags/%E6%A0%91%E6%A2%85%E6%B4%BE/"/>
    
    <category term="Frp" scheme="https://purel.in/tags/Frp/"/>
    
    <category term="内网穿透" scheme="https://purel.in/tags/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/"/>
    
    <category term="WIFI" scheme="https://purel.in/tags/WIFI/"/>
    
    <category term="SSH" scheme="https://purel.in/tags/SSH/"/>
    
    <category term="root" scheme="https://purel.in/tags/root/"/>
    
    <category term="SSR" scheme="https://purel.in/tags/SSR/"/>
    
  </entry>
  
  <entry>
    <title>树莓派：装在口袋里的量子云实验室（硬件篇）</title>
    <link href="https://purel.in/raspberry-pi-quantum-cloud-lab-in-your-pocket-hardware/"/>
    <id>https://purel.in/raspberry-pi-quantum-cloud-lab-in-your-pocket-hardware/</id>
    <published>2020-03-16T23:47:24.000Z</published>
    <updated>2020-03-16T23:47:24.000Z</updated>
    
    <content type="html"><![CDATA[<p><img src="/images/2020/03/IMG_2372-2.JPG" class="lazyload" data-srcset="/images/2020/03/IMG_2372-2.JPG" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="><br>纯粹为了好玩，我花费一周时间用树莓派的板子搭建了一台微型多功能服务器，虽然只有信用卡大小，但是也能科学观看Netflix。<span id="more"></span>通过部署Nginx+Php7.3+Mysql与<a href="https://purel.in/from-san-francisco-to-singapore-we-finally-arrived-in-seoul.html">上个月放在韩国的Linux公网服务器</a>实现了frp内网穿透，你可以从 <a href="https://pi.purel.in/">https://pi.purel.in/</a> 来访问这台微型计算机的状态面版，它现在就放在我家的客厅。从某种程度上你可以理解为这两台相隔异国的服务器，穿透网络实现了量子纠缠。</p><p>不妨畅想一下未来这台Pi可以做什么，比如成为私有云盘实现资料的存储与分享，或是部署网站并通过公网域名实现访问，它会成为这个全新的物联网世界中一朵无处不在的云，这朵云就是徐老师的实验室，它就在我家客厅或者我的口袋里。我说了我会写一篇超详细的部署日记，现在你看到我实现了我的承诺，鉴于篇幅较长，我会把它暂时分为硬件篇和软件篇两个部分，未来随着磨合与熟悉，或许会有拓展的玩法分享。</p><p>我一直在想这样一件事，鉴于网络服务器的成本和存储空间限制，以及家用带宽的不断提升，我是否可以实现网络服务器的本地化部署？即通过域名 <a href="http://xxx.xxx/">http://xxx.xxx</a> 访问到的是本地的服务器，而非异地的IDC数据中心，这将大大提升服务器的操控、管理、以及安全性。部署在远端的服务器只需要做一个跳板或者镜像，那么我可以花费最低的成本购买足够的流量和带宽，而不用担心它的CPU性能和I&#x2F;O限制。所以不论是从效率提升还是成本控制来看，我都需要想办法实现这个设想。</p><h3 id="主机"><a href="#主机" class="headerlink" title="主机"></a>主机</h3><p>目前我已经有了部署在韩国甲骨文机房的VM实例，那么接下来我需要一台低功耗且长期开机联网的本地服务器。上一周的某日我正在电报上面闲云野鹤，通过Dig发现了这块神奇的板子“Raspberry Pi”（树莓派）。虽然我的需求本身排除了对性能和功耗要求极高的图形化界面系统，因为我并不是用它来上网冲浪、看视频、打游戏，我只是需要它默默的做一台Server，但是这块小板子的硬件参数还是给了我惊喜。</p><p><img src="/images/2020/03/pi.png" class="lazyload" data-srcset="/images/2020/03/pi.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==">Raspberry Pi 4 B 具备1.5Ghz运行的64位四核处理器，最高支持以60fps速度刷新的4K分辨率的双显示屏（下巴跌到地板上），高达4GB RAM（可根据型号选择1GB、2GB、4GB，多多益善所以我选择的是4GB版本），2.4&#x2F;5.0 Ghz 双频无线LAN（它还可以用无线发射端成为一台软路由），蓝牙5.0&#x2F;BLE，千兆以太网，USB3.0（这个接口很重要，意味着它完全可以挂载移动硬盘实现超大存储，比如成为私有云盘或家庭多媒体中心），和PoE功能。</p><p>其实树莓派最大的卖点是物联网，也就是说通过编程它的GPIO 40-PIN针脚可以实现更多可能性，比如国外大神们就通过它打造了很多有趣好玩的机器人或者模拟器。最近女儿正饶有兴致的学习编程，这快板子未来可以帮到她。</p><h3 id="屏幕"><a href="#屏幕" class="headerlink" title="屏幕"></a>屏幕</h3><p><img src="/images/2020/03/pi3.52.jpg" class="lazyload" data-srcset="/images/2020/03/pi3.52.jpg" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==">树莓派3.5寸LCD触摸显示屏</p><p>尽管我为它搭配的3.5寸触摸屏幕使它一眼上去很酷，但实际上却用处不大，我未来可能会用一块1寸左右只显示本机IP地址的OLED屏幕代替。因为通过这几天的使用发现，我基本不会去看这块屏幕，一旦通过电视或显示器的连接完成了初次的联网设置，我就可以通过Macbook、iPad Pro、iPhone Pro Max的 VNC（远程桌面）或SSH（远程终端）连接和管理它。如果可以重来一次，我一定不会选则给树莓派配一块LCD屏幕，所以这块屏幕的存在纯粹是为了好看和炫酷……</p><h3 id="外设"><a href="#外设" class="headerlink" title="外设"></a>外设</h3><p>实际上一旦作为服务器开始运行，除了电源外并不需要任何外设，只要有网络就可以连接和管理它。但是一开始还是需要鼠标、键盘、显示器或电视来设置它。基于研究和好奇的精神我也尝试过无头安装，就是离开所有外设让它开机自动连接WIFI从而实现部署，但是发现这样更费劲，除非环境有限，否则不推荐小白尝试。先学会走路在学跑步在任何地方都适用。</p><p><img src="/images/2020/03/IMG_2377.jpg" class="lazyload" data-srcset="/images/2020/03/IMG_2377.jpg" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==">Lofree蓝牙无线键盘 &amp; 希捷移动硬盘1T我翻出来一只HP小鼠标和一只吃灰已久的Lofree蓝牙无线键盘，它也可以通过USB连接线来使用。另外1T的希捷移动硬盘同样摆脱了吃灰的命，我准备在后面用它作为Nextcloud私有云盘使用。移动硬盘吃灰的最大原因就是网络带宽的提升，这让人们大多数的数据存储通过云盘就能够实现，所以一块不能联网只能够通过拔插进行存储操作的移动硬盘越来越不受这个时代的待见。</p><p>因为Pi的到来，这些老物件突然间焕发了光彩，尽管人们说电子产品买新不买旧，但随着自己年龄的增长，我对这些老物件的爱也是越来越多。</p><h3 id="散热"><a href="#散热" class="headerlink" title="散热"></a>散热</h3><p><img src="/images/2020/03/pi4shan.png" class="lazyload" data-srcset="/images/2020/03/pi4shan.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==">树莓派4散热风扇和风扇支架</p><p>散热非常重要，原本树莓派的板子是自带金属散热片的，可以贴在CPU和内存上，但是我担心加上屏幕和外壳后散热堪忧，于是又装了一个固定在主板上的散热风扇。即便是这样，开机温度也达到了57度，连续播放1080p的视频会提示主板过热。所以如过把它当作桌面工作站使用的话，真的不如使用Macbook或者PC更合适，话又说回来，如果加强硬件散热的话，比如加大风扇和散热芯片，它真的可以全面替代桌面电脑。</p><h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p>下面这张照片就是它目前的样子。虽然很折腾，但确实太好玩了，特别在疫情肆虐的特殊时期，这个小东西让我的生活变得十分丰沛。享受整个过程中会忘记时间的流逝，这种体验下来反而收获更多，Just do it。</p><p><img src="/images/2020/03/IMG_2372-2.jpg" class="lazyload" data-srcset="/images/2020/03/IMG_2372-2.jpg" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==">树莓派4B 徐老师的量子云实验室硬件篇大概就是这样子了，接下来是软件篇，因为我是Google、Youtube、Netflix重度使用者，我打造的Pi云也需要能够流畅使用它们，毕竟这个世界上知识搜索方面没有什么可以超过Google的。另外，如果让自己长期置身BAT环境，那么等同于失去和世界的连接。所以软件篇的篇幅会很长，而且涉及大量的计算机术语，假如你不是真的打算像我一样部署一个自己的Pi云的话，真的就不用追了:D。反之，你若崇尚探索的乐趣，那么接下来的干货一定会令你受益。</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;&lt;img src=&quot;/images/2020/03/IMG_2372-2.JPG&quot;&gt;&lt;br&gt;纯粹为了好玩，我花费一周时间用树莓派的板子搭建了一台微型多功能服务器，虽然只有信用卡大小，但是也能科学观看Netflix。</summary>
    
    
    
    <category term="树梅派" scheme="https://purel.in/categories/%E6%A0%91%E6%A2%85%E6%B4%BE/"/>
    
    
    <category term="服务器" scheme="https://purel.in/tags/%E6%9C%8D%E5%8A%A1%E5%99%A8/"/>
    
    <category term="树梅派" scheme="https://purel.in/tags/%E6%A0%91%E6%A2%85%E6%B4%BE/"/>
    
    <category term="LCD" scheme="https://purel.in/tags/LCD/"/>
    
    <category term="Pi" scheme="https://purel.in/tags/Pi/"/>
    
    <category term="3.5inch" scheme="https://purel.in/tags/3-5inch/"/>
    
    <category term="Lofree" scheme="https://purel.in/tags/Lofree/"/>
    
  </entry>
  
  <entry>
    <title>卓越领导者的七项修炼</title>
    <link href="https://purel.in/seven-practices-of-great-leaders/"/>
    <id>https://purel.in/seven-practices-of-great-leaders/</id>
    <published>2020-03-04T05:11:15.000Z</published>
    <updated>2020-03-04T05:11:15.000Z</updated>
    
    <content type="html"><![CDATA[<p><img src="/images/2020/03/psychedelic-treatments-consciousness-disorder-news-oct-2019.jpg" class="lazyload" data-srcset="/images/2020/03/psychedelic-treatments-consciousness-disorder-news-oct-2019.jpg" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></p><blockquote><p>越是在特殊时期，那些人性中的优点和缺点就越是容易被放大。<br>有些人焦虑和混乱，另一些人则更清晰自己。<br>——Jacob Xu</p></blockquote><span id="more"></span><p>这就像是一把双刃剑，有些人会陷入混乱、焦虑和担忧，无论是对工作还是对家庭，然而另一些人却够透过特殊时期更清晰的了解自己。就在去年，职场中的人们还在讨论如何应对VUCA时代「不确定、易变、模糊和复杂」带来的挑战，然而今年伊始，突如其来的新冠疫情就让我们切实体验到了来自新时代的挑战，这对每一位领导者自身的能力和智慧都是一场重要的考验。</p><p>众所周知，那些我们平时不愿拿出来分享的内容具有特别的价值，这就像是每个人生命中的宝石，你不会轻易拿出来与人分享，你会小心翼翼的将宝石藏在保险柜里。但是你知道，宝石的光芒不应该就这样被遮蔽，它在识货的人们手里闪闪发光充满着价值。而那些内部越少杂质的宝石它本身的价值也就越高，七项修炼为你提供去除内在杂质的方法，让你的人生从此闪闪发光。</p><p>这七项修炼分别是<strong>「真诚、正念、交换、更新、分享、即兴、行动」</strong>，我会对我的这篇文章不定期更新，欢迎你随时回来加入讨论，和我一起交流你的看法，或者单纯的分享给你认为对他有帮助的人。</p><h3 id="1-真诚"><a href="#1-真诚" class="headerlink" title="1.真诚"></a>1.真诚</h3><p>你心中的焦虑不安正被特殊时期外部环境带来的刺激无限放大，你在消除自身的焦虑之前不能帮助别人，你必须先说服自己，作为一个卓越的领导者，你完全有能力通过提升自身的觉察力来管理情绪能量，并且通过对能量的管理去激发身边的人，帮助人们在特殊时期做到最好的能量转换。</p><p>非常奇怪的是，在Covid-19肆虐全球的特殊时期，我们被各种教你如何面对疫情的课程轰炸，不乏一些机构似乎出于好心甚至打着公益的名义，帮助人们获得特殊时期生存的能力，这不禁让人联想过去由人类造成的无数个大大小小的灾难，特别是在战争年代，我想那些无数的特殊时期中不会有人教你该怎么生存，这是所有生物与生俱来的基础本能。这和我们后面要提到的分享并非一回事，因为它们要实现的意图完全不同，一种是利己，一种是利他。所以请不要败坏公益这个词，请以纯粹的方式开展你的商业行为。</p><p>真诚是作为一个领导者最重要的品格，它是获得信任的基础。这个世界最美妙的事情就是与他人建立连接，然而一个好的连接的基础就是信任。实际上我们从各种教训中学习如何对他人真诚，但很少去觉察如何对自己真诚。一个对他人真诚却对自己撒谎的人，无法进入领导者最佳状态去解锁内在的智慧。所以一个卓越的领袖首先要学会的就是“不对真我撒谎”，这有助于管理我们的能量不被两个自我的内耗而浪费，一个合一的自我能够产生强大的能量并影响周围的环境。</p><h3 id="2-正念"><a href="#2-正念" class="headerlink" title="2.正念"></a>2.正念</h3><p>正念即正向的念头，我们生活在无意识中，它管理着人们90%的行为。你的能量会追随自己的念头进而产生一系列的行为，所以念头就是能量。如果你追随一个负面的念头，那么你会产生负能量。如果你追随一个正向的念头，那么你会产生正能量。关键是你正被自己的头脑领导着，而没有学习如何控制自己的头脑。</p><p>这个世界不乏聪明的人，但是缺少真正具有大智慧的人，因为我们的念头总是无时无刻在控制着我们。换句话说，我们认为的自己知识自己的头脑，这是一种非常狭隘的自我认知。头脑就像我们的手、脚、嘴巴…是帮助我们在这个世界中更好的生存下去的工具，没有人会认为我的手就是我本身，但我们却一直默许自己的头脑就是自我本身，这很奇怪。这些奇奇怪怪的认知所产生的念头绝非正念，所以每一个领导者要学习的关键一课就是如何控制自己的的头脑，让它产生更大的效能，而不是给自己造成各种各样由偏见和狭隘产生的内耗。</p><p>在商业或职场中的正念更容易被理解，尽管离我想表达的纯粹正念有点距离。这有点像在头脑中安装了一个杀毒软件，通过觉察来随时监控那些糟糕的、阻碍你达成更高绩效的念头。一旦发现它们在头脑中产生，就运行一键删除程序。</p><blockquote><p>不忘初心，方得始终。<br>——《华严经》</p></blockquote><p>虽然人们每天会产生各种各样的行为，大部分是在无意识状态下做出的反应，一些著作中也管这些无意识叫做习惯，必须承认的是有些习惯能帮助你成功，有些则会送你去地狱。我们必须通过提升觉察去接管这些无意识行为，理解这些行为背后的正向意图，这将使我们的注意力围绕真实意图产生正向且积极的能量，这也是管理人生中预期结果的关键因素。</p><h3 id="3-交换"><a href="#3-交换" class="headerlink" title="3.交换"></a>3.交换</h3><p>十年前的游戏没有教程只有攻略，而在那个时候你需要付费才能阅读这些内容，现如今无论是游戏还是培训，全部以免费的形式开展，而当你发现自己真的想要从中获得些什么，自己要付出的比想象的更多，这个世界永远符合能量守恒原则。</p><p>我身边有很多很多朋友想要健身、想要身材变得迷人，但是没有人真正的付出努力，他们大多数认为只要花钱办张健身卡或者请最好的健身教练就能够达成目标，而最终退费的理由又总是惊人的一致。如果你做不到真诚，即不对自己的真我撒谎，那么你就无法学会和这个世界做最好的交换。所有伟大的商人都是这方面的专家，而这或许是阻止你获得更大财富的瓶颈。</p><p>武志红在他的<strong>「巨婴国」</strong>一书中提出“巨婴”的概念，很多人尽管实际年龄很大，但内在却像一个永远长不大的巨婴，处处需要被人迁就和包容。如果环境不能满足自己的要求，那么巨婴就会用自己的方式爆发。这种一味索取的处事方式从根本限制了这群人能力的发展。</p><p>懂得交换意味着真正的成熟，它使我们的人生在各个方面更加平衡。请尽早激活你内在的商人，去和这个世界做最好的交换。</p><h3 id="4-更新"><a href="#4-更新" class="headerlink" title="4.更新"></a>4.更新</h3><p>人们在自己认知范围内做出最好的选择，因为我们无法感知到自己认知范围之外的事物。人和人之间的差距总是在被彼此不同的认知边界拉开，而这些档口在于你如何利用自己的闲暇时光。平时不读书的借口总是我没有时间，你会发现这部分人即便在特殊时期有了大把的时间也不会读书。他们知道读书很重要，但是并不紧急，因为明天之后还有明天，当下总有更重要的事情。</p><p>这里就涉及到“时间”这个概念，爱因斯坦在他的广义相对论中只提出了时空的概念而非时间，他认为时间和空间是捆绑在一起的，但是我们为了生活和商业活动的便利创造了时间的概念。想要理解时间就必须知道什么是重要的，那些真正对你有价值的事情就是重要的事情，它会占满你的全部时间，并令你沉浸其中，在这个过程中人们会完全忘记时间的存在。</p><p>其实这个时期正是人生中最难得的休闲时光，你有大把大把的整块时间可以用来学习和成长。但在那之前，你必须意识到通过学习和阅读不断更新自己的价值所在。</p><p>我的一个朋友说疫情改变了人们的学习方式，中小学开始利用互联网在线教学，家长们可以在家辅导孩子学习。我说No，疫情并没有改变人们的学习方式，而是改变了人们的教育方式。自从人类有了互联网和搜索引擎，我们最有效的学习方式就是Google我想要的答案。“学习”是一个主动的行为，它从来都是主动发生，没有被学习一说，但是你可以被教育。</p><p>我的鱼缸中养了很多的观赏虾，它们每过一段时间就会脱壳，这意味着它们在不断的成长，理论上如果一只虾客户无限的脱壳，那么意味着它可以永生。然而我总是能从鱼缸中发现一些死去的虾，它们的死因只有一个，那就是由于身体虚弱而无法从壳中脱离，被自己的壳活活憋死。我们中国人有很多类似的成语用来形容这些行为，比如作茧自缚、破茧成蝶、涅槃重生等…动物界有很多相关的行为值得我们借鉴，在蝴蝶翱翔天空之前必须要经历痛苦的蜕变过程，而这个过程正是自我更新。</p><p>所有的涅槃都需要打破过去旧的思维模式，这意味着拥抱崭新的未来，成为真正的自己。我们所有的痛苦都来自于无法成为真实的自己。人们或许会说你变了很多，事实上你只是变得更像自己。</p><h3 id="5-分享"><a href="#5-分享" class="headerlink" title="5.分享"></a>5.分享</h3><blockquote><p>世界上所有不快乐的人，都因为他们只想自己获得快乐。<br>——寂天法师</p></blockquote><p>这关于Oneness合一，或者叫它一体性，当你认为自己是独立于这个世界的单独个体，那么就相当于拥抱痛苦的根源，佛教普遍认为“我”的概念是痛苦的根源，它让人们产生分别心，由此造成的分别、分离、区别会让人十分痛苦。然而随着互联网的兴起人们发现彼此之间的距离越来越近了，似乎一定程度上消除了人与人之间的距离和隔阂，人们不再那么重视你的打扮、容貌、着装，因为在互联网中这些都是完全不重要的信息，如果你问正和你聊天的一个网友穿着什么牌子的衣服，对方一定会认为你有毛病。</p><blockquote><p>在互联网上，没人知道你是一条狗<br>On the Internet, nobody knows you’re a dog.<br>——1993.7.5《纽约客》彼得·施泰纳</p></blockquote><p>随着全球人类意识层级的不断提升，人们会逐渐接纳并理解全球一体化、合一、一即一切这样的概念。如果一个人认为世界是一面镜子，自己看到的一切都和自己没有任何的分别与不同，那么根本不需要你教他如何去尊重以及如何去爱。</p><p>6.即兴<br>Yes, and…不是简单的口诀，而是由内而外的接纳、允许和包容。接纳一切的存在、允许一切的存在、包容一切的存在。</p><p>从神经语言科学的角度来说，如果某些外在的事物令你痛苦，一定是你的内在滤镜出了问题。情绪就是能量，正向的能量可以帮助你，负面的能量可以摧毁你。情绪一直是影响人们产生绩效的最大阻碍，你一定听说过这样的话“不要在情绪中做任何决定”。情绪也会令你无法从容面对生活中各种各样的挑战，比如登台演讲之前的紧张，面对疫情时对于未来的焦虑和担忧。如果拿走这些情绪，那么一个人完全可以活出即兴的智慧。从好的一面看，我们可以在特殊时期去处理这些有问题的滤镜，让自己的内在更加健康。</p><p>一个温文尔雅的人也会被一些不经意的琐事触发情绪而暴跳如雷，一个处在负面情绪中的人会完全被情绪掌控。每一个情绪的背后都有一个早年关于自我价值的故事，这些故事不断的积攒在我们的记忆中，就像埋下的地雷，爆炸不知道在什么时候会被触发。这些听上去很恐怖，但相信我，没有人希望自己真实的经历这些情绪。</p><p>过去的故事造成执念，对未来的期待产生欲望，这些令我们无法活在当下。一个人若背负着沉重的负担去生活或工作，这会非常辛苦。尽管很痛苦，但是痛苦能够带来成长和改变，如果你不能像蝴蝶一样蜕壳就不能展翅翱翔。</p><p>即兴是一种脱离头脑和逻辑的智慧。当你的头脑想要说不的时候，请先试着接纳，这也是一种不再将你和世界分开的智慧，可以理解为一种合一的觉知，Oneness。</p><h3 id="7-行动"><a href="#7-行动" class="headerlink" title="7.行动"></a>7.行动</h3><blockquote><p>Just do it.<br>——NIKE</p></blockquote><p>「知行合一」是由王阳明提出的哲学，很多人会讲知行合一很重要，但是其实将知行合一的人也未必可以做到。如果你相信进化论你会知道，人类通过几百万年的进化终于有了头脑——一台超级生物计算机，但我们却不能够百分百的开发和使用它，因为从出生起也从来没有一个说明书教你如何驾驭自己的头脑。不幸的是我们总是被头脑使唤，很多时候我们陷入逻辑思考无法自拔。一个又一个思绪浮现在脑海中挥之不去，有些关于过去而有些是关于不确定的未来。这些让我们无法活在当下，然而我们确认为头脑和思绪就是我们本身。</p><blockquote><p>世界上最遥远的距离就是从知道到做到的距离。<br>——佚名</p></blockquote><p>在这个世界上没有人仅仅通过读一本教人如何骑车的书来学会骑自行车的，Just do it，或许没有什么比直接体验带来的成长更直接。当然，一旦开始行动，就代表你已经具备了足够的勇气，以应对可能发生的各种结果。</p><p>在行为层面产生的结果意味着从想象到现实的转变，可以确定那些能够做到的人百分之百在自己头脑中掌握了相关的要领，如果仍然做不到意味着大脑会启动主动学习来修复那些阻碍我们达成结果的盲区。</p><h3 id="8-结语"><a href="#8-结语" class="headerlink" title="8.结语"></a>8.结语</h3><blockquote><p>成为领袖之前你要专注“自我实现的个人成长”，<br>成为领袖之后你要专注“超越自我的利他爱人”。<br>——杰克·韦尔奇</p></blockquote><p>这个过程并没有你想象中那么难，幸运的是我开发了相关的课程来帮助你完成这些修炼，它会使你的人生从此充满丰盛、乐趣和智慧。</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;&lt;img src=&quot;/images/2020/03/psychedelic-treatments-consciousness-disorder-news-oct-2019.jpg&quot;&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;越是在特殊时期，那些人性中的优点和缺点就越是容易被放大。&lt;br&gt;有些人焦虑和混乱，另一些人则更清晰自己。&lt;br&gt;——Jacob Xu&lt;/p&gt;
&lt;/blockquote&gt;</summary>
    
    
    
    <category term="学习" scheme="https://purel.in/categories/%E5%AD%A6%E4%B9%A0/"/>
    
    
    <category term="领导力" scheme="https://purel.in/tags/%E9%A2%86%E5%AF%BC%E5%8A%9B/"/>
    
    <category term="Leadership" scheme="https://purel.in/tags/Leadership/"/>
    
    <category term="修炼" scheme="https://purel.in/tags/%E4%BF%AE%E7%82%BC/"/>
    
    <category term="合一" scheme="https://purel.in/tags/%E5%90%88%E4%B8%80/"/>
    
    <category term="疫情" scheme="https://purel.in/tags/%E7%96%AB%E6%83%85/"/>
    
    <category term="学习" scheme="https://purel.in/tags/%E5%AD%A6%E4%B9%A0/"/>
    
  </entry>
  
  <entry>
    <title>从旧金山到新加坡，最终我们抵达首尔</title>
    <link href="https://purel.in/from-san-francisco-to-singapore-we-finally-arrived-in-seoul/"/>
    <id>https://purel.in/from-san-francisco-to-singapore-we-finally-arrived-in-seoul/</id>
    <published>2020-02-15T08:30:21.000Z</published>
    <updated>2020-02-15T08:30:21.000Z</updated>
    
    <content type="html"><![CDATA[<p><img src="/images/2020/02/seoul.jpg" class="lazyload" data-srcset="/images/2020/02/seoul.jpg" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="><br>这几日的Purel.in就像是一个旅行家，穿梭于各大洲的数据中心。</p><span id="more"></span><h3 id="速度是关键"><a href="#速度是关键" class="headerlink" title="速度是关键"></a>速度是关键</h3><p>最初它是准备安放在旧金山DigitalOcean数据中心进行托管的，结果Do的速度实在不能令人满意，从大陆访问过去丢包率竟然高达40%，无奈之下只好搬家。</p><p>在经过多方对比后，选择了业内知名的服务商亚马逊，以及它开在AWS的新加坡数据中心。作为一个亚洲机房，从大陆访问过去的速度明显加快了不少，并且连接非常的稳定不丢包。不成想，在一顿常规的操作后，我还是发现了一个致命的问题，导致最终AWS新加坡只是Purel.in旅途中的一个驿站。</p><p>在对AWS的服务器进行一系列操作后，它的IOPS读写限制会降低到非常离谱的地步，这就像是开车从北京的三环堵到五环。毫不夸张的讲，有时只是单单打开一个动态页面，也能造成CPU负载100%进而网站失去响应，在那之前我只是在服务器后台做了一些常规操作而已。各种调试无果之后就把它放在那里干脆不管了，结果十几分钟后它竟然自己恢复正常，经过研究我发现了AWS用的是IOPS积分制，意味着一段时间内你的读写操作不能太频繁，否则就因扣分而被限制，这对于目前运营的动态网站来说是简直是致命的。怎么办，只有继续寻找合适的服务商，可是还有比亚马逊更棒的吗？</p><h3 id="吸引力法则"><a href="#吸引力法则" class="headerlink" title="吸引力法则"></a>吸引力法则</h3><p>大概是吸引力法则起了作用，就在我一筹莫展的时候，通过Telegram的讨论组了解到甲骨文的Oracle Cloud，于是几经辗转，终于来到韩国首尔的甲骨文数据中心。它的连接速度简直可以用美妙来形容，比起亚马逊在新加坡的机房还要棒的多。你大可读完这篇文章后在Purel.in里随便逛一逛，相信你一定能体验到它惊人的速度，这甚至超越了国内大部分的服务商。在服务器的负载方面至今未发现CPU超负荷现象，这让我终于松了一口气，因为这意味着环境部署亦告一段落，接下来就是网站平台的功能设计与优化了。</p><h3 id="Next？"><a href="#Next？" class="headerlink" title="Next？"></a>Next？</h3><p>这应该是下一篇文章的内容了，尽管今天已经实现了完成在线课程后，会生成一张你专属的PDF证书来提供下载和打印，并且解决了它在服务器导出PDF时的中文乱码问题。</p><p>说到这里，我还真的很期待Purel.in未来的样子，想到更多的人会因此而受益，就会满心欢喜。或许这也算是一种妄念吧…（笑～）</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;&lt;img src=&quot;/images/2020/02/seoul.jpg&quot;&gt;&lt;br&gt;这几日的Purel.in就像是一个旅行家，穿梭于各大洲的数据中心。&lt;/p&gt;</summary>
    
    
    
    <category term="网站" scheme="https://purel.in/categories/%E7%BD%91%E7%AB%99/"/>
    
    
    <category term="Purel.in" scheme="https://purel.in/tags/Purel-in/"/>
    
    <category term="Wordpress" scheme="https://purel.in/tags/Wordpress/"/>
    
    <category term="服务器" scheme="https://purel.in/tags/%E6%9C%8D%E5%8A%A1%E5%99%A8/"/>
    
    <category term="数据中心" scheme="https://purel.in/tags/%E6%95%B0%E6%8D%AE%E4%B8%AD%E5%BF%83/"/>
    
  </entry>
  
  <entry>
    <title>又见面了，为什么是Purel.in？</title>
    <link href="https://purel.in/meet-again-why-is-purel-in/"/>
    <id>https://purel.in/meet-again-why-is-purel-in/</id>
    <published>2020-02-11T06:03:44.000Z</published>
    <updated>2020-02-11T06:03:44.000Z</updated>
    
    <content type="html"><![CDATA[<p><img src="/images/2020/02/Apple-iMac.jpg" class="lazyload" data-srcset="/images/2020/02/Apple-iMac.jpg" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="><br>这一切都源于一个纯粹的念头逐渐清晰，这次我抓住了它，并没有让它和往常的同伴一样在我脑海一闪而过。</p><span id="more"></span><h3 id="Hello-World"><a href="#Hello-World" class="headerlink" title="Hello World"></a>Hello World</h3><p>没想到会以这样的方式开始我的2020年，不是指武汉肺炎nCoV，而是又一篇Hello World透过我的指尖发布在了互联网上。为什么要说“又”呢？经过漫长的回忆，距离我发布的上一篇博客大概已经时隔十几年之久了，那个时候人们正在学习如何从Blog断舍离到140字的twitter&#x2F;微博，生怕赶不上时代的潮流被迭代掉，就像每年更新换代的电子设备一般。</p><p>当下，正直nCoV新冠状病毒肺炎肆虐的时期，每个人都在家进行自我隔离。我想，如果一个人长期与世隔绝，可能大脑回路相对平时会更加活跃吧，至少你读到这篇文章时，我已经在这台Macbook前面连续奋斗了几个夜日。</p><p>这一切都源于一个纯粹的念头逐渐清晰，这次我抓住了它，并没有让它和往常的同伴一样在我脑海一闪而过。</p><p>“Touch the world. ”生活仍在推着我们往前走，然而这个念头的悄然浮现既像是对生存的本能渴望，也像是一种完全顺其自然地涌现。</p><h3 id="Touch-The-World"><a href="#Touch-The-World" class="headerlink" title="Touch The World"></a>Touch The World</h3><p>在水中自由自在的鱼并不知道水的存在。</p><p>这个世界上最有趣的事情莫过于「建立连接」了，我就像一只怀着「多目的性」意图的鱼，希望在这个特殊时期可以刚好完成这件事情，即摆脱对各种互联网平台的高度依赖——建立一个真正的网站。</p><p>在功能上它应该主要分担我工作的在线部分，如果能够使我的灵思泉涌有一个安放处就最好不过了。（你正在阅读的这篇文章正是结果的一部分，说明我已经比较满意的实现了后面的小心思。）</p><h3 id="取一个名字"><a href="#取一个名字" class="headerlink" title="取一个名字"></a>取一个名字</h3><p>正如每一个网站的开始，选择一个合适的域名一定是所有网站主最头疼的环节了，我好像比较幸运，在关键字、简短和好记方面找到一款心仪的域名，那就是Purel.in。让我们来看看为什么是它。</p><p>Pure的含义是“纯粹”，包括了正见、无分别、百分百感受。紧跟的字母L则代表不同的意图如Life、Link、Learn、Love…&gt;这个组合代表每一个都意图的背后都是那份纯粹觉察。“.in”的后缀意味着每个人的内在都有一个埋藏着无限潜能的宝藏。</p><blockquote><p>真正重要的东西，用眼睛是看不到的，要用心去感受。<br>——《小王子》</p></blockquote><p>其实如果我们将取名字这件事聚焦在自己的真实意图上，那么接下来的一切都会变得十分轻松，十几年的老东家Godaddy依然没让人失望。然而没想到的是，花费我最多时间的是为Purel.in部署一个合适的环境。</p><h3 id="安家"><a href="#安家" class="headerlink" title="安家"></a>安家</h3><p>在经过GoogleCP、亚马逊EC2&#x2F;LightSail、Vultr和DigitalOcean各种横竖对比后，最终选择将实例开设在了DigitalOcean的旧金山数据中心。到目前为止，我对这台实例的稳定性和访问速度都比较满意，与机器沟通需要脱离我们日常交流的语境，去适应多种奇奇怪怪的计算机语言环境。事实就是这样，通过好的沟通去理解彼此真实意图永远是建立良好合作的前提，无论你对面的家伙能不能喘气。</p><p>从搭建LNMP环境到安装Wordpress，一切都是自然发生的完全没有经过大脑，似乎在直觉中它就该是这样驱动的，甚至不需要我去思考。前几日我的朋友讲到微博的140字限制，这让人在发布内容前会仔细思考每一个字的价值，我十分认同这个观点，因为Less is more。可是让思维自由散漫的向四周无限延伸的感觉并非140字可以承载，它的生命轨迹需要由自己决定。或许这仅仅是我的小Ego，但是我必须尊重它，如此才能体验到纯粹、正见与合一的智慧，哪怕仅仅是一个瞥见。</p><h3 id="新的开始"><a href="#新的开始" class="headerlink" title="新的开始"></a>新的开始</h3><p>文章敲到这里，一旁的手机快要被各种视频会议、讨论和微信留言撕碎，越是这样，这片纯粹的净土就越显得尤为珍贵。</p><blockquote><p>应无所住，而生其心。<br>——《金刚经》</p></blockquote><p>有个声音一直都在提醒自己，众生是怎么迷的？妄想、分别、执念。还有很多工作等待我去完成，至于接下来会发生什么，那应该是被记录在下一篇文章的内容里，自然而然发生的了。</p><p><em>PS. 如果你好奇我是如何从Wordpress转到目前的Hexo方案的，你可以搜索关键词Hexo来获得相关文章。</em></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;&lt;img src=&quot;/images/2020/02/Apple-iMac.jpg&quot;&gt;&lt;br&gt;这一切都源于一个纯粹的念头逐渐清晰，这次我抓住了它，并没有让它和往常的同伴一样在我脑海一闪而过。&lt;/p&gt;</summary>
    
    
    
    <category term="网站" scheme="https://purel.in/categories/%E7%BD%91%E7%AB%99/"/>
    
    
    <category term="Purel.in" scheme="https://purel.in/tags/Purel-in/"/>
    
    <category term="Wordpress" scheme="https://purel.in/tags/Wordpress/"/>
    
  </entry>
  
</feed>
